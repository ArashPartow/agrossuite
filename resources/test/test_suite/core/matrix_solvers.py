import pythonlab
import agros2d

import numpy as np

from test_suite.scenario import Agros2DTestCase
from test_suite.scenario import Agros2DTestResult

class TestMatrixSolversGeneral(Agros2DTestCase):
    @classmethod
    def setUpGeneral(self):
        # store state
        self.save_matrix_and_rhs = agros2d.options.save_matrix_and_rhs
        self.dump_format = agros2d.options.dump_format
        
        # dump format
        agros2d.options.save_matrix_and_rhs = True
        agros2d.options.dump_format = "matlab_mat"
        
        # read reference matrix and rhs from file
        self.reference_sln = [1000000000.0, 852563458.3918582, 1000000000.0, 842445006.2592016, 1000000000.0, 847301711.2134557, 921705290.8685596, 916259235.8294624, 918892724.2885978, 730748428.5802975, 711013028.0042089, 720610802.4295106, 789535098.497021, 774713407.643665, 781845962.5354677, 1000000000.0, 833040074.2561053, 1000000000.0, 837999303.8641874, 908752529.4569612, 913429595.5952653, 693562250.5612199, 701998302.2539546, 761979703.3790423, 768160837.2921607, 1000000000.0, 821254038.143318, 1000000000.0, 836531483.5262318, 1000000000.0, 828841145.319197, 904001480.4250387, 912506504.6571451, 908094866.6892896, 679222525.4889661, 704598409.0932319, 691825865.6952118, 747416659.4153999, 768005731.0045937, 757585035.0242692, 1000000000.0, 844452937.8762735, 917031974.6038843, 717570689.361142, 778651068.7098529, 553065067.0580071, 630416021.7149119, 591378820.7758423, 614904382.8367476, 666750107.6113329, 640591838.3566707, 433296470.5144113, 561446619.8417629, 496984604.5266482, 492773369.27424955, 595358284.7429304, 543650565.4124721, 670257495.092217, 693409683.0069978, 626886145.9564238, 648073032.4636147, 829588286.8790724, 742218309.8137089, 902574934.8928778, 785856316.585689, 786580646.075296, 843635776.8875574, 652498498.6842008, 672642232.944875, 697485769.0499008, 728960644.8852836, 707740674.6757578, 662257314.6386939, 766113609.191139, 701212119.661926, 685401809.3699247, 734267762.7370937, 614463490.4437366, 633097328.0654926, 638541510.0724264, 667392771.3916516, 439656141.7732552, 545702457.7505753, 492580384.86620367, 436104356.9986371, 553289771.4667127, 494473863.5491524, 449656390.02493966, 532552719.50750464, 491201542.9545732, 444095900.6995912, 538755489.3309226, 491451508.4360914, 599007735.7114837, 612664075.5556667, 573641303.3915737, 585981973.6823497, 488131904.9347978, 597705682.8970219, 464965414.38831496, 564611018.3696196, 475091176.403436, 581152332.3799543, 543604911.1423763, 515140546.7908161, 528719331.9642619, 652125937.6033539, 613512204.8614494, 633097948.0689831, 456512256.3486494, 548388848.6228914, 502706360.59991026, 593623957.7439917, 227413432.9499192, 257893142.71602592, 328825590.090968, 343055177.14648974, 279076813.78652644, 301156302.16164523, 242735348.8391693, 335952959.25164145, 290159044.7518961, 287720240.0306818, 357189579.64321184, 322907638.9426835, 272886626.4992439, 350133316.57121164, 312071538.21470577, 423008408.33046347, 423057742.3509573, 376754799.725836, 383659535.9810381, 423019791.86541593, 380202371.1174477, 423233467.4872347, 390614410.2053868, 423127046.6907983, 387128824.7148292, 0.0, 118000430.24643877, 117981359.33376907, 189668840.7431477, 60084311.93733142, 154274253.7431797, 60087343.98117032, 154260001.53849474, 107903768.60060516, 227555173.1910637, 257967250.14407963, 242845086.76695207, 173794218.37649778, 224228491.1690829, 199237912.0009881, 173736774.1441866, 224201989.94230387, 199193357.31450444, 272925031.8046786, 248774950.4306185, 329341776.2377966, 343293231.7013986, 336323100.3457444, 279368851.2943161, 301294978.1605061, 290370800.4793809, 424329957.9579182, 423608467.7920195, 423908170.042161, 377613655.7150157, 384031193.9838835, 380792253.88771695, 350249818.5993263, 312140118.3377868, 423389751.11188114, 387307126.39533305, 395113849.1583249, 393329049.8573753, 442351984.0633769, 429912424.0619374, 393599737.6932282, 435539086.6266292, 396255702.72708577, 423238627.02988416, 394204071.7548451, 425896030.08489305, 292015514.9896507, 314710422.69316596, 345211624.0920444, 354935833.1369492, 302832504.37385887, 349481786.44311416, 340339061.23218656, 368629887.91103727, 327289550.54454744, 361362781.7983983, 344036216.35330033, 368778886.6859718, 356114976.61502016, 389440812.552071, 404690303.9342064, 396721980.0039143, 247459250.1913716, 293576699.0494625, 270446390.74744767, 296823517.0261575, 331778092.41707927, 314068235.0929676, 382142123.1993986, 413490043.3811357, 316905358.96718556, 349964640.5294731, 0.0, 171322737.37336895, 139977582.38888627, 231308559.89725503, 80360145.16047594, 200227602.08311158, 98814807.42839292, 186744256.6628279, 142956361.3179241, 234688121.85669824, 273947647.17224765, 253434115.5717041, 195548538.97247118, 262496310.93277836, 229183492.03926307, 295238532.88588333, 850132276.976182, 821759012.1584792, 777512013.673135, 770834862.4548371, 814833567.5101011, 797235506.6501101, 833388791.35779, 772359761.3281581, 803852194.3051181, 818802305.441951, 780912050.1419116, 800749210.2927079, 816318700.206598, 773483307.5154393, 795889642.2924457, 695226153.1908232, 711329028.6346511, 737769780.8877242, 742254518.8570647, 702301940.3591813, 738602276.6721498, 735793702.9460304, 759224643.1083416, 722438370.9252864, 749021985.5918366, 857692594.4770246, 791787509.284495, 902287222.1260326, 806886528.483002, 825886273.3220189, 855427276.7112069, 719095447.7059665, 712752668.7665898, 756004425.7768704, 759402156.9484695, 831006184.0161335, 783351391.7739804, 808538385.1744565, 726767803.8670177, 755988040.5230372, 600371226.2737039, 655843270.56157, 627198712.0605186, 547451293.6879435, 627074305.059699, 586533463.8563989, 649572445.780791, 683928089.5679847, 665739806.5705537, 686413613.2312536, 669024712.0802402, 704222709.9994434, 916886847.588077, 930783754.8109453, 906788552.7699616, 910856803.9485135, 909113710.3511441, 919033441.3864632, 923261977.4810677, 907692269.1367536, 913238880.4174625, 949714528.1788689, 924411414.7381169, 936258238.1671807, 939519793.9817952, 916291614.9897093, 926618361.0395068, 915694250.0895088, 904617724.6649657, 909125545.6057013, 906102624.9803635, 908659789.8035321, 906329103.1889718, 906463878.0869491, 914336090.7317362, 903671779.8930396, 908705556.4438202, 1000000000.0, 1000000000.0, 949631689.248395, 961042362.0315195, 973636914.821901, 979857292.2637186, 1000000000.0, 955459038.2502854, 976882801.3591949, 1000000000.0, 972331953.076152, 985549248.9206262, 1000000000.0, 966573509.4958557, 982690729.1294366, 930498471.5775983, 944487424.6198888, 937332150.9643946, 960374576.9006813, 952076588.0286891, 1000000000.0, 951048299.89207, 971629312.2802693, 1000000000.0, 962195427.9701778, 979446540.5942917, 926832281.9162759, 947258941.4392744, 1000000000.0, 938960728.4109625, 961407097.3764936, 935831471.2184287, 947981218.5065116, 913114582.7468281, 924190379.5192431, 460423997.4613065, 383061897.14050657, 468996408.6551211, 384678624.45726115, 422753475.22143215, 427742670.54417384, 295549471.0452091, 290512576.938698, 340853686.2784074, 339115038.9709675, 491966150.7847837, 417358555.0717501, 466997267.2079232, 393246363.21032196, 455781312.93536234, 431218596.9397255, 332179767.6870772, 309093369.6331527, 376329200.65302694, 352686512.7208452, 251654719.65120643, 252074658.35182, 246307968.4118406, 141025565.5101302, 206150554.8336692, 163963113.11992973, 449267454.13762146, 376665500.3153008, 410145286.4483659, 354626706.6754235, 312048193.1284855, 328430694.25942945, 271574481.15183955, 248205520.65521953, 350513764.90391344, 306119880.90968597, 758675163.1415704, 600197009.2984111, 616746649.6625828, 495895675.82743555, 690561545.8926034, 549659481.502524, 675871970.2297637, 552776368.9431885, 616553938.1334317, 537048117.4616361, 450011269.47127336, 494883609.449811, 536537483.8092693, 438422078.5323454, 484097992.82381237, 402029003.6575354, 1000000000.0, 850250234.1225917, 1000000000.0, 835052719.2222638, 1000000000.0, 842591742.5009494, 920298400.9919214, 911774763.4567103, 915994628.890949, 728049410.7321877, 701802459.1098721, 714826267.0258064, 786809528.8755887, 765829328.3632222, 776218695.4152609, 820464202.3999615, 1000000000.0, 827705624.9113853, 903771225.765103, 907628933.9632471, 676294835.774811, 688963310.9035609, 745649334.5729079, 755627928.7716948, 1000000000.0, 834532729.4615424, 911466530.1443079, 1000000000.0, 842346613.102582, 915851126.23343, 1000000000.0, 819084685.8812295, 903042706.2232676, 1000000000.0, 826811371.4451236, 907119642.3519659, 701066306.9480209, 765162437.6518313, 714462639.1245106, 775897328.3560536, 674759199.6246649, 744170050.5252961, 687845849.7083098, 754580125.8927759, 622106293.1153101, 660933512.568386, 661351654.4239067, 687555980.5894282, 546226137.4237566, 609228817.1285931, 583802851.4357977, 634846069.1866329, 547239375.3027476, 584266040.6737256, 610595322.0203781, 635719220.6254932, 484800420.2236584, 485371949.8476025, 534108390.9919133, 1310593266.4838846, 1270353961.0485146, 1272887622.8338547, 1228782575.5973985, 1292035612.805573, 1249941020.2244968, 1290727734.3410742, 1250912762.5495765, 1271174886.923929, 1228266314.6089082, 1184336104.4762044, 1206598116.7349572, 1249516281.2767134, 1206572269.9472961, 1228396851.1020799, 1232622988.4943318, 1183910597.8708436, 1253095968.2615676, 1206806828.021363, 1207943241.4054039, 1229867268.6735876, 1138001685.4648314, 1161473149.8918765, 1160595373.962862, 1183995195.2757921, 1380048581.817964, 1308752726.7723017, 1346174448.64654, 1289663759.3340385, 1363306287.4960418, 1299222788.4101493, 1345641723.2544932, 1318591904.3734107, 1332202382.0858905, 1228178241.0933561, 1228182656.9328365, 1228175551.786947, 1269509791.9203124, 1259488209.6989944, 1264489078.3665583, 1328622666.6727345, 1280049361.9407039, 1304780828.3515375, 1228206807.4112785, 1254499481.038665, 1140813307.454117, 1162681574.5774953, 1151834495.247953, 1185097290.143088, 1195868659.0068784, 1190511415.7571998, 1051788421.0128212, 1094588386.7788827, 1073275728.1722809, 1096056884.518604, 1128816549.6435168, 1112549138.3353388, 1173470966.3659966, 1201211101.3920872, 1116056549.0924754, 1145054433.2128155, 1451946602.0890517, 1490558834.932503, 1416960492.3782716, 1486875857.9564576, 1434705271.6582706, 1488575744.4388952, 1472036918.3874557, 1454158268.9220004, 1463064311.749155, 1523033288.5377219, 1539373104.3650494, 1531361490.8789697, 1507541397.6505687, 1515229931.0380735, 1511312863.3051634, 1484313709.9373665, 1398741049.1293569, 1485455411.9420943, 1436580908.3582537, 1445328385.3436444, 1554346622.698891, 1547042559.7207918, 1523440154.912183, 1519276328.3549206, 1484748566.5604343, 1526108979.3568575, 1506605196.9505792, 1468648580.7102401, 1509169629.7168584, 1489897102.7755466, 1514882842.0712786, 1554970278.2243397, 1536412985.8201418, 1500186471.57958, 1541371497.9653375, 1522123124.8287988, 1558340533.495238, 1543333916.4378417, 1542023941.5343375, 1526525428.4151175, 1583322861.494535, 1570597343.3396537, 1572071814.6538372, 1558003441.6863856, 1578738791.9360213, 1569229844.0024464, 1561412636.4463785, 1552110366.1206331, 1600178980.128039, 1593176856.0886097, 1591573463.2628355, 1582858632.4562404, 1593507389.2376459, 1586840587.2199233, 1577571693.0263739, 1569905111.5430293, 1605697735.6229928, 1604354383.2182398, 1602778452.5129585, 1598210398.4437177, 0.0, 116780141.19047637, 0.0, 126345882.09787185, 60429017.743323624, 67272224.42810677, 220287784.04764023, 233263317.163822, 169937273.81851724, 181587621.7934821, 0.0, 101842709.71141194, 0.0, 108744443.40133736, 51810984.24107071, 55619696.60007648, 196620166.2036252, 208144837.26348907, 150106030.6088152, 159549143.35639358, 335476138.41310453, 279149945.08102274, 307603076.51895607, 385214172.69364387, 311631279.3892373, 348948116.3102195, 230927115.7700463, 213690280.0245047, 222294551.28852147, 284060752.4484077, 246525443.20564845, 265396902.47635946, 250077432.39762232, 273139625.4048854, 205126959.71145883, 227446285.55174682, 0.0, 0.0, 119282376.84081292, 110256206.4037561, 60632558.198585704, 55983807.68148326, 0.0, 114716792.77661422, 58270667.86843125, 0.0, 105941659.81475587, 53806794.198855974, 176022750.72577885, 162824821.76287174, 169382803.89761096, 156383697.8128112, 207388460.3815301, 270014123.09094894, 239024158.61655742, 217500940.46013272, 300014718.72432786, 259346041.98370907, 186985290.43645215, 207885078.30861843, 197457883.05983484, 197216339.3716085, 239313129.76682726, 218397990.6743287, 330218191.760334, 300400745.1616093, 378139046.1370025, 339588445.0762302, 228638632.98277208, 218276520.34244072, 280421865.18715477, 259982050.64285135, 0.0, 107137192.11656839, 54454485.698106654, 0.0, 112572470.08086514, 57271956.80643607, 0.0, 96240465.6891372, 48824207.32175241, 0.0, 101692442.27292609, 51638359.711785816, 158098532.0862488, 165962659.88719088, 142283104.6434564, 150204912.5715921, 0.0, 107435011.40803418, 54607541.85706701, 0.0, 101830200.55358325, 51707179.140778586, 118746754.33351602, 60503940.63260553, 0.0, 113066960.14074612, 57534892.548085116, 158516351.88651195, 150403267.9132218, 174771082.60572654, 166634712.66808707, 1624970111.2086196, 1527184114.7963903, 1438588992.7322261, 1355174062.839964, 1544904126.9675348, 1449461034.3523955, 1579698221.3750472, 1397695447.381632, 1499292593.3876557, 1398344566.466707, 1267228537.1543992, 1336545912.0817983, 1466932813.1802332, 1311450733.1970432, 1395188233.28226, 1129829686.7871046, 1104462947.3028796, 1302037888.427623, 1241235946.3800895, 1115171719.4662428, 1271049573.8465345, 1100296457.6888757, 1188814329.672786, 1098907407.4013627, 1213473962.856449, 1750796946.921848, 1711521857.840025, 1721780503.0128534, 1645827880.669783, 1743865928.5425236, 1684574527.9164867, 1737980135.4049873, 1689005539.9169436, 1720082380.1059396, 1613880882.342371, 1524980680.0714607, 1573710609.5000074, 1670701900.0928648, 1591475149.651521, 1636141803.1934125, 1683149168.3366728, 1593874548.9015622, 1642797116.9760482, 1466769406.8819904, 1535456036.7802038, 1446666440.637738, 1361782776.8038554, 1405707455.142056, 1539777495.6436284, 1450565057.1992035, 1498197868.4198568, 1201267600.955278, 1130727787.693103, 1161643899.4945138, 1333150322.5281975, 1256260683.7355893, 1294093685.9426126, 1315412975.2634544, 1396673356.968059, 1110374071.5564907, 1220890618.910565, 794441608.0001723, 941304831.5621815, 900107849.4941944, 893646504.436984, 848141471.5757655, 822153304.1723236, 921208797.5279552, 871207514.7498317, 747200772.0055895, 856952127.6757821, 804475272.3372431, 768816944.2006315, 878462011.499095, 825472877.5071776, 1041699758.6480116, 998335620.5591441, 991118837.9775603, 950219617.8312182, 1020565032.5404985, 971230724.7842071, 950357120.3585812, 905406479.0542421, 974934841.9162306, 928199395.0793593, 907581116.6560929, 726826050.9951651, 872232448.9732589, 734809878.9921846, 887313467.9717972, 834941001.0293872, 803692787.7566873, 814676481.608081, 1036027740.1304257, 989923374.5098232, 1012268369.2838516, 974645762.1898078, 934015194.5920728, 952878806.2762305, 732240030.6922604, 862231205.5872262, 800628863.8432034, 969222904.0302882, 918178021.5505681, 1140731609.1071572, 1143001898.087592, 1070727155.1414708, 1189712165.838311, 1106916133.903224, 1187788488.3555877, 1107084515.673274, 1148980475.1966302, 1091811393.3413231, 1034333694.8011438, 1063950522.9258144, 1091972542.8485315, 1031822197.5205028, 1061661236.6168361, 1002807977.978541, 568703309.0916967, 516768364.5332408, 581112753.3342903, 526704516.06681746, 564357032.3446165, 528166039.653379, 563088040.6115382, 516650515.93118644, 662091314.7012858, 617187448.6178936, 677938591.9027942, 631453245.9179653, 635068532.7631388, 600005296.8085696, 647777663.8362957, 606680897.2413021, 630986561.3977207, 676132465.5945957, 611130159.2975066, 669595523.2586453, 684744815.1347414, 714686385.7868338, 656096058.7257622, 692114270.9631993, 593392084.4734007, 563327732.784166, 658043581.5952824, 625185757.3279779, 727544511.3656713, 751971952.044769, 760922881.0270559, 787521679.1100484, 694537669.6060873, 715448327.212321, 704891119.9236321, 736209546.9509513, 675294263.5268159, 1482478101.0543978, 1405029702.8821127, 1269181320.9282377, 1231052805.5764408, 1385148728.6128511, 1323510308.0887861, 1444768852.8888726, 1249956480.2724223, 1354615353.9544435, 1319940440.1890924, 1194564605.424721, 1259789522.6438015, 1363399089.0536904, 1212568417.8486054, 1291876693.5945966, 971283319.8669442, 1008617190.1328514, 1132213691.6654532, 1126473088.4092224, 989734387.2749496, 1128951597.5776625, 1047675438.1246811, 1123975281.3115246, 1027918247.1029654, 1124800301.9482367, 907299258.2817341, 1227862266.3084142, 1061190723.4167492, 1179469498.7879186, 987075357.9370345, 1022789149.8164338, 1147980865.8043118, 1087173744.5489767, 650293065.5406752, 865697229.8025767, 762559932.5479003, 783289675.1655042, 967206415.6266419, 878997258.5391248, 1274727858.5662556, 1130222121.9194407, 1205465845.8779712, 960495205.2618016, 1048677899.1819496, 0.0, 562322342.9368967, 352658183.989383, 719876172.5426965, 184251651.61300886, 642684791.886942, 303710454.1759981, 547401958.6644477, 429793618.59029317, 782667610.2456505, 872946447.1927196, 828230604.2354968, 507194633.52178603, 794107759.460627, 658080519.348345, 917004541.4423417, 0.0, 117765539.50908504, 0.0, 184552770.7834642, 0.0, 151168417.34312937, 59552740.61959877, 94783147.25153553, 76568945.43974578, 228221509.911957, 346581603.0058547, 289615519.4472157, 174244531.6503593, 268446466.79765385, 222397935.92944786, 0.0, 218542548.4609955, 115408815.51144227, 399742358.19528776, 312411050.9734585, 0.0, 304936256.701722, 0.0, 205322813.01902518, 0.0, 254953947.6883401, 186478302.26043296, 108684084.1612742, 141894896.14788133, 491033540.51277775, 366168727.3049561, 430635310.04601276, 405406569.31370556, 290306303.56785285, 348226372.5037897, 0.0, 159763816.0933818, 81958426.23159102, 298599516.2469015, 231957927.89517635, 637182719.4492218, 502371155.7571228, 572289137.2442085, 567904667.8164864, 437533220.7724467, 504864957.2798998, 700496016.8373444, 561874991.0534068, 633851860.2092015, 427202286.5483308, 365646072.8396491, 483924169.1533437, 580739144.8498728, 724968116.9758717, 656580311.2729971, 534800936.8211586, 677217199.3220308, 609538483.141848, 676172075.5052897, 833509066.6519636, 758916467.5062559, 628455435.2356925, 778062395.8246529, 707079290.884278, 844447101.0505371, 787255100.3830949, 795587597.2012537, 738889753.2604282, 963349019.9934961, 901310243.4129678, 901664691.4241802, 842576117.1374662, 560049984.5745771, 555042678.0857737, 557300338.7681732, 362367425.26520044, 435007551.284012, 389271929.6329451, 846160354.3084145, 756341543.0159899, 801531155.3474306, 719441973.3092897, 662211088.1812196, 688089995.152115, 564339984.6772017, 484207056.130385, 714332327.9616246, 641652525.1732849, 1047681864.2817105, 941334238.9651772, 995359960.7757277, 954486733.6593072, 854936241.2193402, 904900561.4208896, 1087066187.6960828, 1145761220.721389, 1129375372.9469383, 1018176158.1613553, 1074958497.6293314, 886920664.0315735, 805570375.840099, 1025768791.869684, 959831005.3146719, 0.0, 0.0, 310246663.23717237, 328955702.28159344, 161120101.40911362, 171019074.77843618, 0.0, 318819439.84542537, 165453550.031098, 0.0, 340289497.56518525, 177384806.95494953, 576587107.2780833, 611697349.7113271, 448566693.78922397, 475503748.88563156, 593595544.000792, 461274400.68964314, 630641701.0033519, 490901729.2286889, 744276765.8360312, 652931950.1692111, 955404412.1459098, 786116751.7632046, 855335850.9512691, 721247695.9756187, 696181237.6336428, 871396739.2226139, 787279503.586553, 613365471.6218207, 699635464.7352753, 656818800.616929, 1046486078.0848114, 848049984.6805803, 949658592.5511572, 741809578.6612449, 0.0, 473050983.8765199, 367460690.06311446, 302357515.0707869, 196531419.29321343, 0.0, 408954939.623333, 227584928.77889818, 0.0, 335709237.7536347, 175663132.65043083, 619598862.4740132, 518771845.1828734, 563354137.0963408, 481211761.93467695, 1570247773.2461326, 1527207646.7669785, 1434190081.7875512, 1420589192.208311, 1511846730.3159904, 1478897425.33481, 1549099052.570811, 1426121997.437171, 1494833857.0827944, 1482774678.0296702, 1417518947.7310236, 1451594415.9717042, 1504971085.3372009, 1417733955.4148178, 1464392386.8120234, 1266934388.2841742, 1332907346.106492, 1350566951.6670227, 1232150395.9168422, 1339914227.0549076, 1340552202.4296339, 1380493708.2493873, 1303581192.0318325, 1364300034.9355206, 1663442189.7901294, 1640374628.3391173, 1641156591.2840943, 1601216159.347296, 1657668672.5054517, 1624663161.1324415, 1654504657.4172325, 1622633118.0457091, 1643156368.7109337, 1597333568.1025388, 1551138543.5691879, 1576734190.5480132, 1621180539.4439538, 1577257864.959451, 1602400838.2653062, 1612624178.0375109, 1569055909.3652976, 1591686651.2118642, 1520000393.2678275, 1545027138.91588, 1538122490.21184, 1485863190.0657403, 1513886078.156513, 1569295657.058592, 1520061221.893459, 1546882957.9015167, 1471631673.4429781, 1410668576.9976919, 1442493501.8178573, 1505003171.2507417, 1449128089.7201252, 1478672972.5792243, 1453801140.9313838, 1488427007.7846172, 1376488221.9311035, 1416377320.364329, 1628808703.6243613, 1617772342.3887663, 1618090480.2823064, 1609903905.4530683, 1625116413.5604, 1615695322.6079087, 1622699407.5792897, 1613514070.687939, 1619858304.1917787, 1610928242.0528746, 1604151859.4128673, 1609499908.965157, 1613817641.3090558, 1606566135.88183, 1612084873.5871015, 1593749142.1512969, 1586161979.6058278, 1607651895.656211, 1600139755.9017687, 1589719662.3431084, 1603516884.3052294, 1580578907.840864, 1594616866.259084, 1583114821.6377127, 1596996023.6405883, 1593544647.4951518, 1565019402.0569098, 1579372945.0706804, 1594861173.1020155, 1552208489.37803, 1574193132.7047484, 1593231897.4974382, 1576362791.364378, 1584609780.0551434, 1537594192.1022124, 1550971172.4402688, 1507769996.1800606, 1529789952.535729, 1561716519.176784, 1568695294.9583406, 1644224773.719363, 1627484779.7143707, 1638009281.6073818, 1653391379.5586455, 1633287872.7931945, 1645704813.8113234, 1635951191.0066698, 1622173347.123149, 1630958905.8672569, 1612631724.3828554, 1616288449.469095, 1609590258.2935276, 1012026549.9633765, 1048328155.7722985, 1029840456.3859493, 1032278220.4496765, 1071688435.7220081, 1051839449.9795748, 967861194.0296605, 999869085.0069953, 983313539.3906159, 990725863.1593115, 1024427528.2501552, 1007082010.5060154, 1087513549.7706985, 1067551077.4776835, 1112966876.332274, 1092016909.0965238, 1035646599.5873623, 1017373433.6917839, 1061716749.7061138, 1042669431.7716496, 915401860.7043779, 972815963.5245767, 884650707.5490578, 957608763.3571656, 942687586.5093497, 919320375.5208577, 1038163562.7538376, 1039743002.11796, 1004873891.0976417, 998099476.6676574, 942941917.8942269, 986898700.2030151, 963954916.225679, 1036834211.1212679, 1011325711.2564801, 1112628070.202929, 1148789315.2332342, 1126256889.177518, 1167888625.6951292, 1099745174.9967356, 1130504912.5997858, 1075666610.469887, 1083415154.7358906, 1068470440.727079, 1708309534.9920912, 1689180368.842091, 1730667067.0073946, 1700923779.8032653, 1719616440.6961024, 1694934237.0787191, 1701437813.1411202, 1720321348.9961147, 1710812844.924492, 1646891586.5623286, 1631906263.4376714, 1639881760.143414, 1671154131.08324, 1671687614.023503, 1671458044.6116025, 1741117373.0803149, 1706139823.7013762, 1729168624.9680812, 1623178540.4726362, 1671124595.5577812, 1685352603.3143206, 1665132142.5078938, 1679196991.1651685, 1696745632.0251508, 1677026934.9005094, 1690161905.127064, 1674125786.6439016, 1652768306.5442178, 1668046899.5672016, 1609645249.745019, 1642299157.9041586, 1628731838.7576447, 1656780094.4246712, 1590017062.4422727, 1627202143.2479563, 1543501610.159632, 1580202754.0324728, 1590764841.788988, 1611436072.2130342, 1490710856.536097, 1546709337.2181706, 1499131071.8018274, 1566816527.0650682, 1420482743.9944298, 911530776.2566112, 938458408.7538074, 933557420.762333, 925600988.2882112, 921865818.4122037, 915035742.4256924, 936683612.4590974, 924752205.7966598, 896923184.9800406, 923209425.3797708, 910319470.697468, 905356431.5520782, 929056688.2343856, 916998347.1495838, 970836014.2526659, 960337526.1324675, 953657704.0599977, 946432337.2547631, 965779735.3602524, 950450539.1798296, 948090950.5374162, 935768585.453674, 954466015.707202, 941555597.9947281, 875127306.7619613, 919599074.830267, 862780218.6148264, 917470323.7774315, 898385883.7185805, 891575142.2518635, 957549790.5637375, 962575551.9765612, 939231609.9950235, 941004091.0756968, 886683073.6223217, 921567720.110803, 904718633.5174055, 952734188.2721217, 937515688.4172677, 1009426472.5231655, 984912624.8381685, 997433690.484127, 1030258665.8433863, 998200120.616183, 1014542952.4243599, 989516723.0222338, 972264210.5794075, 981123821.1744565, 971696697.5772183, 980997581.8230759, 962846604.1137793, 819302593.6301874, 723244054.5511485, 769916144.2587756, 903176847.0733471, 769849801.3187777, 833258307.9060158, 674594953.285291, 635776092.1038018, 655056118.7388135, 744128323.0624433, 678717523.1923348, 710876214.1259813, 635835457.2079304, 678765823.6069149, 655141441.1721783, 710957413.675137, 597984519.7486322, 616769215.9766635, 616792967.5587583, 647419147.001046, 545595776.5672581, 527438718.5199206, 536498179.885215, 608897073.9476355, 580878894.2834086, 594826709.1139656, 483883197.3972039, 474969849.877329, 479414864.4957294, 509450748.93606, 518421502.831307, 553297469.8410238, 567039319.1258193, 466167382.1825002, 470552325.37391514, 527698826.6014077, 581041358.3655252, 536913396.9949583, 595077589.9327749, 518545282.0158391, 567120553.7314578, 475371402.0761002, 480056314.21893704, 470745822.4399997, 876187802.4795938, 867801644.7935019, 898135582.0489479, 900734670.6067963, 849210350.7019933, 834824427.9262831, 859947909.17828, 846812357.5826367, 888480097.266802, 882744869.4987012, 897245140.1852763, 897006714.9829901, 872655855.2986239, 861768068.3361332, 880181691.567538, 870964428.8460419, 854468742.3865857, 863228464.0637827, 838749415.8402544, 848751549.8073378, 880861409.9642718, 888052932.7256135, 868561851.78574, 876438796.6254601, 849543487.9947737, 833780587.2251205, 875619132.5730907, 863517163.8397728, 895191305.4986423, 900657693.2575847, 902316844.7118618, 906634962.5755851, 890447244.1248387, 897414656.0057235, 888465090.1284221, 895989943.4692875, 883089031.5520531, 723851070.332193, 770739129.9083652, 771251814.0194778, 834203674.3839206, 634681347.0725797, 655303160.9439145, 678488226.389571, 711479500.7522144, 636220576.8977574, 679190736.981349, 657555459.5134975, 712781244.2859435, 594415838.4031036, 614399057.7758862, 615185578.7493459, 646445908.0694675, 528234791.16956323, 537679347.1305447, 580808495.1265205, 595612657.6156514, 425281399.4568666, 424744860.94417804, 476522158.7638541, 480902485.0678369, 509712315.93435806, 518906991.70397824, 551725122.0514435, 566181083.007331, 426823578.3017684, 425960871.6659716, 468143596.1159554, 472261178.4143185, 531016262.4214625, 582958670.3871388, 541930319.571397, 598837448.2011383, 520281873.46298665, 567260324.9769813, 429307434.54444, 479946446.5241358, 431065212.8056722, 486209642.72061133, 427919583.17439973, 473937371.87135553, 346464769.2598411, 338327808.4827983, 386486035.9131212, 382270522.3172637, 262420596.18188253, 245607560.4121074, 305130822.71979654, 292801597.434475, 362888993.3265414, 354646006.12212235, 395256778.1048046, 390806140.8010992, 295611130.0035719, 279085258.08227915, 329684383.1647469, 317420989.05129683, 192777282.19272012, 156525973.01063484, 156168912.48162356, 109183651.02601029, 263672801.15183514, 247404503.65359813, 228602267.5603859, 202584556.68449438, 228065759.58475783, 201630060.89427447, 279739401.7545552, 254096608.85226914, 348996030.75624776, 389757469.5401704, 342176208.1190354, 387335890.7253362, 355906468.5951261, 392411129.85509384, 306979647.9892611, 295544790.6939785, 318360134.47820747, 1401357159.6343408, 1324150717.8445144, 1403504160.7203598, 1347726979.326703, 1402210451.5495284, 1335371606.268647, 1364532537.4530826, 1376689384.5817962, 1370242998.8039799, 1282798976.3254344, 1256391095.7196016, 1280171372.78339, 1316489867.1185184, 1297470274.0034509, 1407533354.4605713, 1375887726.7877235, 1405265928.3445835, 1361247264.2671127, 1391932813.8084652, 1383912676.5772195, 1342667475.1813118, 1311726740.0270863, 1359432650.340922, 1337206879.378847, 1482044390.7358887, 1446317697.0727394, 1472692952.8278165, 1425367830.8720574, 1476503835.4919443, 1435545962.9887226, 1464608474.5607867, 1449456120.1271393, 1456442126.4209316, 1427264472.6740816, 1400758678.4977126, 1413994688.6624205, 1407740884.5820036, 1470972961.0215619, 1415984311.256382, 1440223063.8985918, 1443939429.8071115, 1374930992.20166, 1387675377.9396064, 1464649586.203778, 1496947198.1116674, 1454086700.8116026, 1505666590.602321, 1459080867.0828917, 1491337804.8995504, 1476475248.0972233, 1483624730.3166656, 1434695371.5932758, 1429763863.4851565, 1431960180.883082, 1488968942.4350157, 1449785145.8440275, 1470063905.356178, 1428172584.0376568, 1580128784.6204267, 1591288611.2686222, 1553014943.315978, 1576068461.134244, 1567881750.9602349, 1584392958.621372, 1586094577.2698562, 1565363379.869503, 1576722274.5630527, 1599309394.9912162, 1592533616.665265, 1596224824.0327427, 1595696589.6382666, 1585124348.6770678, 1590896178.7550125, 1535388061.940972, 1566274546.0666528, 1551957410.558141, 1588233856.456889, 1578364872.287274, 1599689123.9852273, 1602261533.9456806, 1601032988.4134138, 1591670299.030034, 1597749892.294333, 1594900666.0969803, 1605852235.1998482, 1605769071.5403156, 1605799516.6424844, 1604350575.0659666, 1604911737.2964962, 1604627734.997721, 1604158173.904242, 1603282713.5728219, 1602151286.1845925, 1600152148.3084064, 1605739043.5973434, 1605745561.794267, 1605350289.314758, 1605136971.9183967, 1602473841.1056983, 1603377054.2825959, 1598350469.2471805, 1600409834.4899566, 1605731475.7201536, 1605731837.6801152, 1604926003.3527932, 1605145311.9472947, 1601384569.4605415, 1595922274.0469534, 1605723275.8907917, 1604646280.223984, 1370970494.7310603, 1319918262.1006007, 1425691436.9348726, 1366488557.1690795, 1344999155.8397017, 1396072841.3504481, 1274570587.2254486, 1309987189.7063825, 1296326252.1767614, 1337598908.4543977, 1230324851.2162936, 1208214299.236854, 1306443731.0184739, 1267383974.1160696, 1218251240.8828487, 1286045400.6279786, 1194475682.61265, 1236168978.374251, 1200312975.781778, 1250704213.9612813, 1205874614.6015418, 1173431804.679065, 1245821872.2914839, 1216545803.4245224, 1115758266.3765497, 1075758600.989957, 1162642805.859276, 1126635550.8064191, 1239795346.7674615, 1277161797.034047, 1155503746.4003434, 1199342888.5611682, 1035103598.0162269, 1070697784.132182, 1051136001.4107001, 909464838.1245682, 992138408.8606633, 949782298.1516674, 1140890065.6971438, 1142714791.5493705, 1140207188.8789728, 1092527918.2626019, 1034475613.7865624, 1147963012.0452402, 1420487638.3090024, 1442607672.0541584, 1431547283.649816, 1436630131.3053246, 1464578863.933793, 1450732875.7510889, 1385657566.985031, 1393048523.445835, 1389243761.236636, 1403503002.407232, 1418778999.8093472, 1411059813.9814928, 1453653213.9066706, 1478132047.4512691, 1397083706.0623212, 1426659488.735887, 1384455535.4883642, 1401026404.6145575, 1402765833.9785333, 1419104080.1071346, 1365585681.562249, 1382423555.8184662, 1349331369.9356952, 1367231963.3293567, 1367811079.0829644, 1385674110.561839, 1330248900.99706, 1348204637.2712047, 1336409594.657272, 1342803269.8123255, 1365616280.4620216, 1366587529.7890935, 1305471510.0337734, 1317932538.909904, 1330177029.502954, 1364920983.857928, 1292875893.047351, 1594941997.4382472, 1589226070.4783576, 1603849138.5754092, 1603157910.4251523, 1600110462.9144847, 1597234738.16219, 1592200310.0118117, 1603448335.956265, 1598689566.9096317, 1582697474.9534276, 1602662692.1532648, 1594052174.0551748, 1586046204.8706715, 1602819635.9367857, 1595632068.270676, 1607058123.200374, 1608558805.6101573, 1606162819.3480656, 1606946468.617431, 1607703590.779298, 1606460048.0221653, 1608335212.9166253, 1609621882.5742972, 1607517715.9460838, 1587999984.9217446, 1601766823.2061694, 1596093940.2952683, 1584163913.3497202, 1600678782.809518, 1593889792.2079072, 1591604616.3702133, 1602761780.6790957, 1598125484.0384476, 1606219753.1242347, 1605109703.9108737, 1605977448.7318287, 1604663880.7488363, 1606555715.5683484, 1605559103.778434, 1572856526.9320471, 1563308511.3279135, 1581040407.475497, 1574680268.444521, 1552679689.4916344, 1534601972.9029868, 1563416300.9928782, 1549979624.3023856, 1581533943.6626081, 1586901648.3344662, 1568817694.8651676, 1575503793.340866, 1537052226.7967145, 1517907519.4267576, 1544960634.5237892, 1526184732.6074448, 1521124088.6665688, 1502491924.4663916, 1529069318.1997948, 1509950177.922574, 1569281957.3645196, 1554212693.5806866, 1576360139.6291366, 1561751480.8776739, 1552951407.6806288, 1537936437.6578891, 1561473558.54142, 1546256481.6687458, 1527480561.130043, 1502135727.9152331, 1523834606.2008805, 1501624023.5474257, 1532074650.7433333, 1504152544.2183628, 1566973576.7638476, 1549013441.1909626, 1559983528.2196863, 1543247064.0036285, 1573859769.2766175, 1555191514.3985124, 1589208939.141585, 1579807428.6153297, 1596984634.6511228, 1587611894.518076, 1579234688.3639123, 1570607575.0226533, 1597368137.022503, 1604326638.620618, 1587267961.5435135, 1039905082.0555441, 949501052.455905, 1035391462.8962076, 925962775.5052265, 1062153289.9377754, 1014218280.1220462, 1048857518.0248204, 979304796.1637654, 1188089124.3980594, 1118749612.8357642, 1208997530.9250128, 1128726112.9171374, 1149277692.7665648, 1107122881.8761616, 1168026383.1055014, 1111427458.685958, 1171816673.8569598, 1221139149.5813386, 1129199468.7171783, 1182318481.3875017, 1254076203.9716363, 1299364000.5612938, 1213695668.806793, 1260557498.7312672, 1118812999.1731818, 1073027753.0550681, 1204208838.6438558, 1162651736.4147723, 1313803846.477177, 1342944892.06047, 1365400212.083448, 1396458028.037913, 1254997258.1970792, 1280837773.6262891, 1284014176.058239, 1332863219.7484124, 1229292990.3163838, 1780625510.712164, 1775290493.5334728, 1788503235.62105, 1776652486.1499362, 1785133980.1369295, 1776264307.7037766, 1780134862.0978365, 1785823862.4678233, 1783382698.630279, 1751852036.5181458, 1739296499.390424, 1745965028.868181, 1765917103.853094, 1761387312.9268746, 1763936399.8015091, 1791163860.228839, 1775439896.41515, 1790430825.3955142, 1776288636.3898973, 1787365975.2132964, 1787006630.439019, 1724021227.0809627, 1731945117.3870845, 1754571598.9982092, 1758189334.1462512, 1742440517.9519958, 1767886114.3835151, 1761197321.9530926, 1759834171.0708745, 1752148210.4483302, 1751866637.924115, 1768095623.558926, 1760306861.9319637, 1693112905.5836022, 1725570067.2964833, 1710082842.767794, 1722783032.4613767, 1747044294.9221668, 1735399833.738878, 1774777608.5319266, 1768643348.0850236, 1774526952.7238352, 1739508907.835472, 1757012397.304603, 1605227025.392894, 1684079135.9707985, 1647817845.4311786, 1653763902.7624424, 1706581969.2093017, 1681910690.680551, 1629655925.2840493, 1563385293.757545, 1547984320.0106378, 1658313331.8003678, 1608189496.9991794, 1714457165.8946917, 1727900659.7571247, 1682726264.2340097, 1699342035.8090286, 786654479.539396, 958075701.3883859, 763305321.8736452, 954492688.8835248, 876032340.3228058, 863187101.8547567, 1033989357.0421948, 1038121728.6719499, 854089564.5905948, 984272912.6269847, 817277190.2087729, 967653765.8393166, 921069632.4997944, 894947815.5675648, 1043988704.61617, 1035473089.2286265, 839097454.8420599, 999001974.4903355, 923208602.6476251, 839753903.576195, 1019196009.8309993, 934936072.1982112, 844426122.0230287, 987671677.5741266, 918895462.3581339, 1067877482.6597402, 1094221982.0541162, 1051314017.1934608, 658177204.1544691, 569264314.8792057, 601501911.7400006, 454653174.43308794, 723138369.9925445, 668368039.2639699, 750746733.1622834, 728362722.7818478, 781818592.1037617, 1681116911.9350088, 1704742738.0950832, 1717249438.6721892, 1734712234.1878793, 1570749484.2909057, 1599316765.9539597, 1632731636.6587834, 1660156627.88623, 1615810928.5926838, 1651377821.8489048, 1658078417.809245, 1691599752.8356965, 1506669759.162093, 1539775783.678718, 1565574355.159791, 1601091770.1279116, 1426763248.650573, 1431937145.2116754, 1504986548.7704175, 1524962385.9182267, 1334741276.2115042, 1317604328.6441638, 1420749962.4973218, 1423071802.3076382, 1465515044.0990744, 1485138090.0229816, 1372246863.6734107, 1353048605.7710485, 1522624689.145054, 1572310207.2926009, 1566182331.8322597, 1615944866.0838192, 1474241380.9702604, 1522325046.6157174, 1466857066.9599614, 1509056187.2071137, 1421288894.4722497]

    @classmethod
    def tearDownClass(self):
        # restore state
        agros2d.options.save_matrix_and_rhs = self.save_matrix_and_rhs
        agros2d.options.dump_format = self.dump_format

    @classmethod
    def model(self, solver, matrix_solver="", matrix_solver_parameters=""):
        problem = agros2d.problem(clear = True)
        problem.coordinate_type = "axisymmetric"
        problem.mesh_type = "triangle"

        electrostatic = problem.field("electrostatic")
        electrostatic.analysis_type = "steadystate"
        electrostatic.matrix_solver = solver
        electrostatic.number_of_refinements = 1
        electrostatic.polynomial_order = 2
        electrostatic.adaptivity_type = "disabled"
        electrostatic.solver = "linear"

        electrostatic.matrix_solver_parameters['external_solver'] = matrix_solver
        electrostatic.matrix_solver_parameters['external_parameters'] = matrix_solver_parameters        
                
        electrostatic.add_boundary("Source", "electrostatic_potential", {"electrostatic_potential" : 1e9})
        electrostatic.add_boundary("Ground", "electrostatic_potential", {"electrostatic_potential" : 0})
        electrostatic.add_boundary("Neumann", "electrostatic_surface_charge_density", {"electrostatic_surface_charge_density" : 0})
        electrostatic.add_material("Air", {"electrostatic_permittivity" : 1, "electrostatic_charge_density" : 1})
        electrostatic.add_material("Dielectric 1", {"electrostatic_permittivity" : 3, "electrostatic_charge_density" : 20})
        electrostatic.add_material("Dielectric 2", {"electrostatic_permittivity" : 4, "electrostatic_charge_density" : 30})
        
        geometry = problem.geometry()
        geometry.add_edge(0, 0.2, 0, 0.08, boundaries = {"electrostatic" : "Neumann"})
        geometry.add_edge(0.01, 0.08, 0.01, 0, refinements = {"electrostatic" : 1}, boundaries = {"electrostatic" : "Source"})
        geometry.add_edge(0.01, 0, 0.03, 0, boundaries = {"electrostatic" : "Neumann"})
        geometry.add_edge(0.03, 0, 0.03, 0.08)
        geometry.add_edge(0.03, 0.08, 0.05, 0.08)
        geometry.add_edge(0.05, 0, 0.03, 0, boundaries = {"electrostatic" : "Neumann"})
        geometry.add_edge(0.05, 0.08, 0.05, 0, refinements = {"electrostatic" : 1}, boundaries = {"electrostatic" : "Ground"})
        geometry.add_edge(0.06, 0, 0.06, 0.08, boundaries = {"electrostatic" : "Ground"})
        geometry.add_edge(0.05, 0.08, 0.06, 0.08, refinements = {"electrostatic" : 1}, boundaries = {"electrostatic" : "Ground"})
        geometry.add_edge(0.06, 0, 0.2, 0, boundaries = {"electrostatic" : "Neumann"})
        geometry.add_edge(0.2, 0, 0, 0.2, angle = 90, boundaries = {"electrostatic" : "Neumann"})
        geometry.add_edge(0.01, 0.08, 0.03, 0.08)
        geometry.add_edge(0.01, 0.08, 0, 0.08, refinements = {"electrostatic" : 1}, boundaries = {"electrostatic" : "Source"})

        geometry.add_label(0.019, 0.021, materials = {"electrostatic" : "Dielectric 1"})
        geometry.add_label(0.0379, 0.051, materials = {"electrostatic" : "Dielectric 2"})
        geometry.add_label(0.0284191, 0.123601, materials = {"electrostatic" : "Air"})
        
        computation = problem.computation()
        computation.solve()
        solution = computation.solution("electrostatic")
    
        return solution.solution()

    """    
    @classmethod    
    def analyse_system(self, filename_matrix, filename_rhs, filename_sln):
        import pylab as pl

        # read matrix and rhs from file
        matrix, rhs, sln = self.read_system(filename_matrix, filename_rhs, filename_sln)
              
        # size of the matrix
        print(("Matrix size: " + str(len(rhs))))
        print(("Number of nonzeros: " + str(matrix.getnnz()) + " (" + str(round(float(matrix.getnnz()) / (len(rhs)**2) * 100.0, 3)) + " %)"))
        
        # visualize matrix sparsity pattern
        fig = pl.figure()
        pl.spy(matrix, markersize=1)
        fn_pattern = pythonlab.tempname("png")
        pl.savefig(fn_pattern, dpi=60)
        pl.close(fig)   
        pythonlab.image(fn_pattern)

    @classmethod        
    def read_system(self, filename_matrix, filename_rhs, filename_sln):
        mat_object = sio.loadmat(filename_matrix)
        matrix = mat_object["matrix"]
        rhs_object = sio.loadmat(filename_rhs)
        rhs = rhs_object["rhs"]
        sln_object = sio.loadmat(filename_sln)
        sln = sln_object["sln"]
        
        return matrix, rhs, sln
    """
class TestMatrixSolversInternal(TestMatrixSolversGeneral):
    def setUp(self):  
        self.setUpGeneral()
        
    def tearDown(self):
        self.tearDownClass()
        
    def test_umfpack(self):
        # UMFPACK
        sln = self.model("umfpack")       
        self.assertTrue(np.allclose(self.reference_sln, sln, rtol=1e-15, atol=1e-6), "UMFPACK sln failed.")

    def test_dealii(self):
        # deal.II
        sln = self.model("dealii")
        self.assertTrue(np.allclose(self.reference_sln, sln, rtol=1e-6), "dealii sln failed.")                                                   

class TestMatrixSolversExternal(TestMatrixSolversGeneral):
    def setUp(self):  
        self.setUpGeneral()

    def tearDown(self):
        self.tearDownClass()
        
    def test_external_umfpack(self):
        # UMFPACK
        sln = self.model("external", "solver_UMFPACK.ext")        
        self.assertTrue(np.allclose(self.reference_sln, sln, rtol=1e-6), "UMFPACK (external) sln failed.")

    def test_external_mumps(self):
        # MUMPS
        sln = self.model("external", "solver_MUMPS.ext")        
        self.assertTrue(np.allclose(self.reference_sln, sln, rtol=1e-6), "MUMPS (external) sln failed.")

    def test_external_paralution(self):
        # PARALUTION
        sln = self.model("external", "solver_PARALUTION.ext")        
        self.assertTrue(np.allclose(self.reference_sln, sln, rtol=1e-6), "PARALUTION (external) sln failed.")

    def test_external_trilinos(self):
        # TRILINOS
        sln = self.model("external", "solver_TRILINOS.ext")        
        self.assertTrue(np.allclose(self.reference_sln, sln, rtol=1e-6), "TRILINOS (external) sln failed.")

    def test_external_petsc(self):
        # PETSC
        sln = self.model("external", "solver_PETSC.ext")        
        self.assertTrue(np.allclose(self.reference_sln, sln, rtol=1e-6), "PETSC (external) sln failed.")



if __name__ == '__main__':
    import unittest as ut

    suite = ut.TestSuite()
    result = Agros2DTestResult()
    suite.addTest(ut.TestLoader().loadTestsFromTestCase(TestMatrixSolversInternal))
    suite.addTest(ut.TestLoader().loadTestsFromTestCase(TestMatrixSolversExternal))    
    suite.run(result)
