import agros2d

import numpy as np

from tests.scenario import Agros2DTestCase
from tests.scenario import Agros2DTestResult

class TestMatrixSolversGeneral(Agros2DTestCase):
    @classmethod
    def setUpGeneral(self):
        # store state
        self.save_matrix_and_rhs = agros2d.options.save_matrix_and_rhs
        self.dump_format = agros2d.options.dump_format
        
        # dump format
        agros2d.options.save_matrix_and_rhs = True
        agros2d.options.dump_format = "matlab_mat"
        
        # read reference matrix and rhs from file
        self.reference_sln = [1000000000.0, 852563458.3918585, 1000000000.0, 842445006.2592019, 1000000000.0, 847301711.213456, 921705290.8685606, 916259235.8294626, 918892724.288598, 730748428.5802969, 711013028.0042094, 720610802.4295104, 789535098.4970207, 774713407.6436653, 781845962.535468, 1000000000.0, 833040074.2561054, 1000000000.0, 837999303.8641878, 908752529.4569612, 913429595.5952655, 693562250.5612206, 701998302.2539555, 761979703.3790432, 768160837.2921612, 1000000000.0, 821254038.1433171, 1000000000.0, 836531483.5262313, 1000000000.0, 828841145.3191961, 904001480.4250385, 912506504.6571448, 908094866.6892892, 679222525.4889654, 704598409.0932312, 691825865.6952112, 747416659.4153988, 768005731.0045933, 757585035.0242686, 1000000000.0, 844452937.8762734, 917031974.6038842, 717570689.3611413, 778651068.7098526, 553065067.0580063, 630416021.7149111, 591378820.7758416, 614904382.836747, 666750107.6113319, 640591838.3566699, 433296470.5144113, 561446619.8417635, 496984604.52664876, 492773369.27424884, 595358284.74293, 543650565.4124719, 670257495.0922165, 693409683.0069971, 626886145.9564245, 648073032.4636148, 829588286.8790731, 742218309.8137099, 902574934.8928778, 785856316.5856897, 786580646.0752966, 843635776.8875577, 652498498.6842014, 672642232.9448757, 697485769.049901, 728960644.8852843, 707740674.6757585, 662257314.638694, 766113609.1911399, 701212119.6619266, 685401809.3699253, 734267762.7370944, 614463490.4437369, 633097328.0654932, 638541510.0724266, 667392771.3916519, 439656141.77325636, 545702457.7505763, 492580384.8662045, 436104356.9986376, 553289771.4667135, 494473863.5491531, 449656390.0249407, 532552719.50750536, 491201542.95457405, 444095900.69959193, 538755489.3309231, 491451508.4360922, 599007735.7114842, 612664075.5556673, 573641303.3915743, 585981973.6823503, 488131904.9347991, 597705682.8970226, 464965414.38831556, 564611018.36962, 475091176.4034366, 581152332.3799548, 543604911.1423774, 515140546.7908167, 528719331.96426255, 652125937.6033548, 613512204.8614495, 633097948.0689837, 456512256.34865046, 548388848.622892, 502706360.599911, 593623957.7439921, 227413432.94991904, 257893142.71602577, 328825590.0909678, 343055177.14648956, 279076813.78652626, 301156302.16164494, 242735348.83916914, 335952959.2516412, 290159044.75189584, 287720240.03068143, 357189579.6432117, 322907638.9426832, 272886626.4992436, 350133316.5712116, 312071538.21470547, 423008408.33046347, 423057742.3509573, 376754799.7258359, 383659535.981038, 423019791.86541593, 380202371.11744756, 423233467.4872346, 390614410.2053868, 423127046.6907984, 387128824.7148292, 0.0, 118000430.24643868, 117981359.33376907, 189668840.7431476, 60084311.93733144, 154274253.74317962, 60087343.981170304, 154260001.5384947, 107903768.60060515, 227555173.19106334, 257967250.14407933, 242845086.7669517, 173794218.37649745, 224228491.1690826, 199237912.0009878, 173736774.14418653, 224201989.94230366, 199193357.31450433, 272925031.8046783, 248774950.43061823, 329341776.2377963, 343293231.7013984, 336323100.3457441, 279368851.29431576, 301294978.16050595, 290370800.4793806, 424329957.95791715, 423608467.792019, 423908170.0421601, 377613655.7150152, 384031193.98388326, 380792253.88771653, 350249818.59932625, 312140118.3377866, 423389751.11188084, 387307126.3953329, 395113849.15832496, 393329049.8573759, 442351984.0633775, 429912424.0619382, 393599737.69322866, 435539086.6266299, 396255702.7270866, 423238627.029885, 394204071.75484604, 425896030.0848939, 292015514.9896513, 314710422.6931666, 345211624.0920448, 354935833.1369498, 302832504.3738593, 349481786.44311464, 340339061.23218745, 368629887.9110382, 327289550.5445481, 361362781.79839915, 344036216.3533006, 368778886.68597263, 356114976.61502075, 389440812.5520711, 404690303.934207, 396721980.00391483, 247459250.19137242, 293576699.0494633, 270446390.74744844, 296823517.0261581, 331778092.4170802, 314068235.09296846, 382142123.1993997, 413490043.3811366, 316905358.9671863, 349964640.5294741, 0.0, 171322737.3733694, 139977582.38888672, 231308559.89725554, 80360145.16047606, 200227602.08311194, 98814807.4283931, 186744256.6628284, 142956361.3179244, 234688121.85669848, 273947647.1722481, 253434115.57170445, 195548538.9724719, 262496310.93277898, 229183492.0392638, 295238532.88588405, 850132276.9761829, 821759012.1584785, 777512013.6731353, 770834862.454837, 814833567.5101019, 797235506.6501096, 833388791.3577899, 772359761.328158, 803852194.3051182, 818802305.4419515, 780912050.1419119, 800749210.2927085, 816318700.2065974, 773483307.5154392, 795889642.2924454, 695226153.1908237, 711329028.6346513, 737769780.8877243, 742254518.857065, 702301940.3591815, 738602276.6721499, 735793702.9460305, 759224643.1083416, 722438370.9252869, 749021985.5918367, 857692594.4770244, 791787509.2844957, 902287222.1260328, 806886528.4830027, 825886273.3220191, 855427276.7112074, 719095447.7059666, 712752668.7665906, 756004425.776871, 759402156.9484701, 831006184.0161343, 783351391.7739806, 808538385.1744568, 726767803.8670175, 755988040.5230374, 600371226.2737046, 655843270.5615703, 627198712.0605192, 547451293.6879447, 627074305.0596997, 586533463.8563999, 649572445.7807915, 683928089.5679849, 665739806.5705541, 686413613.2312536, 669024712.0802408, 704222709.9994434, 916886847.5880771, 930783754.8109452, 906788552.769961, 910856803.9485139, 909113710.3511435, 919033441.3864632, 923261977.4810675, 907692269.1367536, 913238880.4174625, 949714528.1788685, 924411414.7381169, 936258238.1671805, 939519793.9817947, 916291614.9897094, 926618361.0395068, 915694250.0895089, 904617724.6649654, 909125545.6057001, 906102624.9803635, 908659789.8035316, 906329103.188971, 906463878.0869488, 914336090.7317362, 903671779.8930393, 908705556.44382, 1000000000.0, 1000000000.0, 949631689.2483954, 961042362.0315197, 973636914.8219001, 979857292.2637185, 1000000000.0, 955459038.2502853, 976882801.3591945, 1000000000.0, 972331953.0761518, 985549248.9206269, 1000000000.0, 966573509.4958555, 982690729.1294366, 930498471.5775989, 944487424.6198885, 937332150.9643947, 960374576.900681, 952076588.028689, 1000000000.0, 951048299.8920703, 971629312.2802693, 1000000000.0, 962195427.9701779, 979446540.5942918, 926832281.916275, 947258941.4392745, 1000000000.0, 938960728.4109625, 961407097.3764936, 935831471.218428, 947981218.506511, 913114582.7468277, 924190379.5192425, 460423997.46130633, 383061897.1405066, 468996408.65512127, 384678624.45726126, 422753475.22143203, 427742670.54417384, 295549471.0452095, 290512576.9386983, 340853686.2784075, 339115038.9709677, 491966150.78478396, 417358555.0717509, 466997267.207923, 393246363.2103221, 455781312.9353629, 431218596.93972546, 332179767.68707716, 309093369.63315296, 376329200.65302724, 352686512.72084546, 251654719.65120667, 252074658.35182005, 246307968.4118406, 141025565.51013026, 206150554.8336694, 163963113.1199298, 449267454.1376217, 376665500.31530064, 410145286.44836605, 354626706.6754236, 312048193.1284854, 328430694.25942945, 271574481.1518398, 248205520.65521982, 350513764.90391326, 306119880.9096859, 758675163.141571, 600197009.2984108, 616746649.6625825, 495895675.8274356, 690561545.8926033, 549659481.5025239, 675871970.2297635, 552776368.9431888, 616553938.1334317, 537048117.461636, 450011269.4712734, 494883609.449811, 536537483.80926967, 438422078.53234553, 484097992.8238126, 402029003.65753525, 1000000000.0, 850250234.1225921, 1000000000.0, 835052719.2222638, 1000000000.0, 842591742.5009494, 920298400.9919218, 911774763.4567103, 915994628.890949, 728049410.7321879, 701802459.1098714, 714826267.0258061, 786809528.8755887, 765829328.3632218, 776218695.4152609, 820464202.399962, 1000000000.0, 827705624.911385, 903771225.7651026, 907628933.9632471, 676294835.77481, 688963310.9035603, 745649334.5729074, 755627928.7716943, 1000000000.0, 834532729.4615427, 911466530.1443081, 1000000000.0, 842346613.1025825, 915851126.2334303, 1000000000.0, 819084685.8812306, 903042706.2232685, 1000000000.0, 826811371.445124, 907119642.3519663, 701066306.948021, 765162437.6518314, 714462639.1245108, 775897328.3560538, 674759199.6246651, 744170050.5252968, 687845849.7083097, 754580125.8927763, 622106293.1153085, 660933512.5683855, 661351654.4239057, 687555980.5894275, 546226137.4237554, 609228817.1285927, 583802851.4357965, 634846069.1866324, 547239375.3027465, 584266040.6737247, 610595322.0203772, 635719220.6254925, 484800420.2236573, 485371949.8476013, 534108390.99191236, 1310593266.4838812, 1270353961.0485117, 1272887622.8338518, 1228782575.597396, 1292035612.8055694, 1249941020.224494, 1290727734.341071, 1250912762.5495737, 1271174886.9239256, 1228266314.6089058, 1184336104.4762027, 1206598116.7349553, 1249516281.2767105, 1206572269.9472945, 1228396851.1020775, 1232622988.4943302, 1183910597.8708413, 1253095968.2615647, 1206806828.021361, 1207943241.4054017, 1229867268.673585, 1138001685.4648314, 1161473149.8918755, 1160595373.962861, 1183995195.2757907, 1380048581.8179595, 1308752726.7722974, 1346174448.6465354, 1289663759.3340352, 1363306287.4960372, 1299222788.4101455, 1345641723.2544887, 1318591904.3734064, 1332202382.0858862, 1228178241.0933542, 1228182656.9328346, 1228175551.7869449, 1269509791.920309, 1259488209.6989915, 1264489078.3665555, 1328622666.67273, 1280049361.9407003, 1304780828.3515332, 1228206807.411276, 1254499481.0386622, 1140813307.4541159, 1162681574.5774944, 1151834495.247952, 1185097290.1430871, 1195868659.006878, 1190511415.7571988, 1051788421.0128231, 1094588386.778882, 1073275728.1722822, 1096056884.5186043, 1128816549.6435158, 1112549138.3353386, 1173470966.3659956, 1201211101.3920858, 1116056549.0924747, 1145054433.2128148, 1451946602.0890462, 1490558834.9324996, 1416960492.3782656, 1486875857.9564533, 1434705271.6582642, 1488575744.4388914, 1472036918.387451, 1454158268.9219954, 1463064311.74915, 1523033288.537719, 1539373104.3650458, 1531361490.8789668, 1507541397.6505663, 1515229931.0380702, 1511312863.3051605, 1484313709.9373627, 1398741049.129352, 1485455411.9420903, 1436580908.3582485, 1445328385.3436394, 1554346622.6988883, 1547042559.7207892, 1523440154.9121795, 1519276328.3549166, 1484748566.5604303, 1526108979.3568544, 1506605196.9505756, 1468648580.7102356, 1509169629.7168555, 1489897102.775543, 1514882842.0712733, 1554970278.2243376, 1536412985.8201387, 1500186471.5795748, 1541371497.965335, 1522123124.828795, 1558340533.4952354, 1543333916.4378388, 1542023941.534334, 1526525428.4151149, 1583322861.4945343, 1570597343.339652, 1572071814.6538353, 1558003441.6863832, 1578738791.9360201, 1569229844.0024445, 1561412636.4463766, 1552110366.1206303, 1600178980.1280365, 1593176856.088608, 1591573463.262833, 1582858632.456239, 1593507389.2376451, 1586840587.2199223, 1577571693.026373, 1569905111.5430279, 1605697735.62299, 1604354383.2182374, 1602778452.5129561, 1598210398.4437158, 0.0, 116780141.19047661, 0.0, 126345882.09787227, 60429017.743323766, 67272224.42810696, 220287784.04764056, 233263317.16382247, 169937273.8185175, 181587621.79348263, 0.0, 101842709.71141191, 0.0, 108744443.4013375, 51810984.241070695, 55619696.60007656, 196620166.2036252, 208144837.26348922, 150106030.60881513, 159549143.35639372, 335476138.413104, 279149945.0810225, 307603076.5189557, 385214172.69364333, 311631279.3892374, 348948116.31021947, 230927115.77004552, 213690280.0245043, 222294551.2885208, 284060752.4484069, 246525443.20564806, 265396902.4763589, 250077432.3976225, 273139625.40488577, 205126959.71145856, 227446285.5517467, 0.0, 0.0, 119282376.84081262, 110256206.40375589, 60632558.198585585, 55983807.68148315, 0.0, 114716792.77661394, 58270667.86843112, 0.0, 105941659.81475575, 53806794.198855914, 176022750.7257784, 162824821.76287138, 169382803.8976105, 156383697.81281096, 207388460.38152978, 270014123.0909486, 239024158.6165571, 217500940.4601323, 300014718.72432745, 259346041.98370868, 186985290.43645173, 207885078.308618, 197457883.05983436, 197216339.37160817, 239313129.76682672, 218397990.67432827, 330218191.7603334, 300400745.1616087, 378139046.1370016, 339588445.0762296, 228638632.98277155, 218276520.34244022, 280421865.18715405, 259982050.6428508, 0.0, 107137192.11656815, 54454485.69810653, 0.0, 112572470.08086495, 57271956.806436, 0.0, 96240465.68913709, 48824207.32175238, 0.0, 101692442.27292602, 51638359.71178574, 158098532.08624855, 165962659.8871906, 142283104.64345613, 150204912.57159188, 0.0, 107435011.408034, 54607541.85706692, 0.0, 101830200.55358307, 51707179.1407785, 118746754.3335158, 60503940.632605456, 0.0, 113066960.14074588, 57534892.54808502, 158516351.8865116, 150403267.91322148, 174771082.60572606, 166634712.6680867, 1624970111.2086222, 1527184114.796392, 1438588992.7322278, 1355174062.839965, 1544904126.9675384, 1449461034.352397, 1579698221.3750498, 1397695447.3816333, 1499292593.3876579, 1398344566.466708, 1267228537.1543987, 1336545912.0817986, 1466932813.180234, 1311450733.197044, 1395188233.282261, 1129829686.7871077, 1104462947.3028803, 1302037888.4276245, 1241235946.38009, 1115171719.4662445, 1271049573.8465364, 1100296457.6888757, 1188814329.6727858, 1098907407.4013631, 1213473962.8564491, 1750796946.9218504, 1711521857.840024, 1721780503.0128562, 1645827880.6697838, 1743865928.5425262, 1684574527.9164867, 1737980135.4049892, 1689005539.916945, 1720082380.1059408, 1613880882.3423688, 1524980680.0714605, 1573710609.5000062, 1670701900.0928638, 1591475149.651521, 1636141803.193412, 1683149168.3366745, 1593874548.901564, 1642797116.9760494, 1466769406.881991, 1535456036.7802043, 1446666440.637736, 1361782776.8038552, 1405707455.1420546, 1539777495.643626, 1450565057.1992037, 1498197868.4198556, 1201267600.9552748, 1130727787.6931021, 1161643899.4945116, 1333150322.5281944, 1256260683.7355883, 1294093685.9426105, 1315412975.2634544, 1396673356.9680598, 1110374071.5564904, 1220890618.9105647, 794441608.0001732, 941304831.5621827, 900107849.4941952, 893646504.4369847, 848141471.5757666, 822153304.1723244, 921208797.5279559, 871207514.7498326, 747200772.005592, 856952127.6757838, 804475272.3372453, 768816944.2006329, 878462011.4990962, 825472877.5071791, 1041699758.6480114, 998335620.559144, 991118837.9775597, 950219617.8312185, 1020565032.540498, 971230724.784207, 950357120.358582, 905406479.0542434, 974934841.9162309, 928199395.0793601, 907581116.6560947, 726826050.9951663, 872232448.9732611, 734809878.9921851, 887313467.9717991, 834941001.0293885, 803692787.7566888, 814676481.6080823, 1036027740.1304257, 989923374.5098237, 1012268369.283852, 974645762.1898087, 934015194.592074, 952878806.2762314, 732240030.6922618, 862231205.5872283, 800628863.8432053, 969222904.030289, 918178021.5505695, 1140731609.1071558, 1143001898.0875905, 1070727155.1414701, 1189712165.8383088, 1106916133.9032233, 1187788488.3555863, 1107084515.6732728, 1148980475.1966286, 1091811393.341323, 1034333694.8011435, 1063950522.9258137, 1091972542.8485303, 1031822197.5205024, 1061661236.6168355, 1002807977.9785413, 568703309.0916961, 516768364.5332402, 581112753.3342905, 526704516.06681764, 564357032.344616, 528166039.65337884, 563088040.6115372, 516650515.9311859, 662091314.7012856, 617187448.6178931, 677938591.9027945, 631453245.9179654, 635068532.7631385, 600005296.8085691, 647777663.8362955, 606680897.2413014, 630986561.397721, 676132465.5945966, 611130159.2975068, 669595523.2586457, 684744815.1347421, 714686385.7868352, 656096058.725763, 692114270.9632004, 593392084.4734008, 563327732.7841662, 658043581.5952827, 625185757.3279781, 727544511.3656716, 751971952.0447694, 760922881.0270565, 787521679.1100491, 694537669.6060874, 715448327.2123212, 704891119.9236326, 736209546.9509523, 675294263.526816, 1482478101.054402, 1405029702.882118, 1269181320.9282422, 1231052805.5764458, 1385148728.6128557, 1323510308.0887904, 1444768852.8888764, 1249956480.2724268, 1354615353.954448, 1319940440.1890955, 1194564605.4247253, 1259789522.643805, 1363399089.0536947, 1212568417.8486097, 1291876693.5946007, 971283319.8669477, 1008617190.1328547, 1132213691.6654572, 1126473088.4092262, 989734387.2749527, 1128951597.5776665, 1047675438.1246845, 1123975281.3115284, 1027918247.1029688, 1124800301.9482405, 907299258.2817363, 1227862266.3084173, 1061190723.4167525, 1179469498.787921, 987075357.9370368, 1022789149.8164358, 1147980865.8043146, 1087173744.5489793, 650293065.5406767, 865697229.8025789, 762559932.547902, 783289675.1655055, 967206415.6266447, 878997258.5391269, 1274727858.566259, 1130222121.9194446, 1205465845.8779745, 960495205.2618045, 1048677899.181953, 0.0, 562322342.9368985, 352658183.9893838, 719876172.5426987, 184251651.61300942, 642684791.8869439, 303710454.1759989, 547401958.6644493, 429793618.5902943, 782667610.2456526, 872946447.1927221, 828230604.2354991, 507194633.52178687, 794107759.4606293, 658080519.3483468, 917004541.4423443, 0.0, 117765539.50908497, 0.0, 184552770.7834642, 0.0, 151168417.34312928, 59552740.61959872, 94783147.25153552, 76568945.43974574, 228221509.9119569, 346581603.00585496, 289615519.44721574, 174244531.65035915, 268446466.797654, 222397935.92944783, 0.0, 218542548.46099567, 115408815.51144232, 399742358.1952881, 312411050.97345877, 0.0, 304936256.7017222, 0.0, 205322813.0190252, 0.0, 254953947.68834016, 186478302.26043293, 108684084.16127415, 141894896.14788133, 491033540.51277786, 366168727.3049564, 430635310.04601276, 405406569.31370544, 290306303.5678528, 348226372.50378966, 0.0, 159763816.09338167, 81958426.23159094, 298599516.24690163, 231957927.89517623, 637182719.4492223, 502371155.7571234, 572289137.2442087, 567904667.8164866, 437533220.7724471, 504864957.2799, 700496016.8373446, 561874991.0534072, 633851860.2092015, 427202286.5483311, 365646072.8396494, 483924169.153344, 580739144.8498734, 724968116.9758726, 656580311.2729977, 534800936.8211588, 677217199.3220314, 609538483.1418484, 676172075.5052902, 833509066.6519637, 758916467.5062568, 628455435.2356931, 778062395.824654, 707079290.8842789, 844447101.050538, 787255100.3830959, 795587597.2012548, 738889753.2604291, 963349019.9934963, 901310243.4129679, 901664691.4241807, 842576117.1374668, 560049984.5745769, 555042678.0857743, 557300338.7681732, 362367425.2652001, 435007551.2840123, 389271929.63294506, 846160354.3084152, 756341543.0159901, 801531155.3474311, 719441973.3092896, 662211088.1812198, 688089995.152115, 564339984.6772023, 484207056.1303852, 714332327.9616251, 641652525.1732855, 1047681864.2817103, 941334238.965178, 995359960.7757282, 954486733.659308, 854936241.2193403, 904900561.4208902, 1087066187.6960824, 1145761220.721387, 1129375372.946936, 1018176158.1613554, 1074958497.6293306, 886920664.0315737, 805570375.8400992, 1025768791.869684, 959831005.3146721, 0.0, 0.0, 310246663.23717314, 328955702.2815943, 161120101.40911394, 171019074.77843657, 0.0, 318819439.8454258, 165453550.03109828, 0.0, 340289497.56518596, 177384806.95494992, 576587107.2780844, 611697349.711328, 448566693.78922474, 475503748.8856323, 593595544.0007931, 461274400.68964386, 630641701.003353, 490901729.22868973, 744276765.8360314, 652931950.169212, 955404412.1459123, 786116751.7632065, 855335850.9512705, 721247695.9756203, 696181237.6336435, 871396739.2226158, 787279503.5865546, 613365471.6218219, 699635464.7352767, 656818800.6169304, 1046486078.0848136, 848049984.6805818, 949658592.551159, 741809578.6612462, 0.0, 473050983.8765202, 367460690.0631149, 302357515.0707869, 196531419.29321364, 0.0, 408954939.6233334, 227584928.7788984, 0.0, 335709237.75363517, 175663132.65043107, 619598862.4740132, 518771845.1828741, 563354137.0963411, 481211761.9346778, 1570247773.2461247, 1527207646.766971, 1434190081.7875469, 1420589192.2083066, 1511846730.3159854, 1478897425.334805, 1549099052.5708036, 1426121997.4371665, 1494833857.0827894, 1482774678.0296652, 1417518947.7310193, 1451594415.971699, 1504971085.3371954, 1417733955.4148128, 1464392386.8120184, 1266934388.2841718, 1332907346.1064887, 1350566951.667019, 1232150395.91684, 1339914227.054904, 1340552202.4296312, 1380493708.2493837, 1303581192.0318298, 1364300034.935517, 1663442189.7901254, 1640374628.3391113, 1641156591.2840896, 1601216159.347289, 1657668672.5054476, 1624663161.1324348, 1654504657.4172266, 1622633118.045704, 1643156368.7109284, 1597333568.1025333, 1551138543.5691829, 1576734190.548008, 1621180539.4439483, 1577257864.959445, 1602400838.2653003, 1612624178.0375044, 1569055909.365291, 1591686651.2118576, 1520000393.2678216, 1545027138.915874, 1538122490.2118366, 1485863190.0657363, 1513886078.1565087, 1569295657.0585876, 1520061221.8934538, 1546882957.9015117, 1471631673.4429772, 1410668576.9976897, 1442493501.8178551, 1505003171.2507384, 1449128089.7201219, 1478672972.5792215, 1453801140.9313793, 1488427007.7846124, 1376488221.9311016, 1416377320.3643258, 1628808703.6243541, 1617772342.388757, 1618090480.2822986, 1609903905.4530592, 1625116413.5603921, 1615695322.6078997, 1622699407.5792809, 1613514070.687931, 1619858304.1917696, 1610928242.052869, 1604151859.4128597, 1609499908.96515, 1613817641.3090475, 1606566135.8818219, 1612084873.5870936, 1593749142.151291, 1586161979.6058204, 1607651895.6562045, 1600139755.9017608, 1589719662.3431015, 1603516884.305222, 1580578907.8408554, 1594616866.2590756, 1583114821.6377053, 1596996023.6405802, 1593544647.4951465, 1565019402.0569046, 1579372945.070675, 1594861173.102011, 1552208489.3780262, 1574193132.7047434, 1593231897.497433, 1576362791.3643718, 1584609780.0551376, 1537594192.1022077, 1550971172.4402637, 1507769996.1800575, 1529789952.5357249, 1561716519.1767778, 1568695294.9583347, 1644224773.7193573, 1627484779.7143655, 1638009281.607376, 1653391379.558639, 1633287872.7931895, 1645704813.8113174, 1635951191.006664, 1622173347.1231425, 1630958905.867251, 1612631724.38285, 1616288449.46909, 1609590258.2935216, 1012026549.9633771, 1048328155.7722982, 1029840456.3859502, 1032278220.4496784, 1071688435.7220076, 1051839449.9795756, 967861194.0296623, 999869085.0069954, 983313539.3906165, 990725863.1593133, 1024427528.2501554, 1007082010.5060165, 1087513549.770698, 1067551077.4776827, 1112966876.3322737, 1092016909.096523, 1035646599.5873617, 1017373433.691784, 1061716749.706113, 1042669431.7716495, 915401860.7043779, 972815963.5245767, 884650707.5490581, 957608763.3571657, 942687586.5093498, 919320375.5208579, 1038163562.753837, 1039743002.1179597, 1004873891.0976416, 998099476.667657, 942941917.8942267, 986898700.2030156, 963954916.2256794, 1036834211.1212678, 1011325711.2564801, 1112628070.202928, 1148789315.233233, 1126256889.177517, 1167888625.695128, 1099745174.9967346, 1130504912.599785, 1075666610.4698865, 1083415154.7358902, 1068470440.7270783, 1708309534.9920874, 1689180368.842087, 1730667067.0073943, 1700923779.8032646, 1719616440.6961005, 1694934237.0787158, 1701437813.1411157, 1720321348.996114, 1710812844.9244893, 1646891586.5623238, 1631906263.4376698, 1639881760.143411, 1671154131.0832355, 1671687614.0235007, 1671458044.611599, 1741117373.0803158, 1706139823.7013752, 1729168624.9680815, 1623178540.4726348, 1671124595.55778, 1685352603.3143163, 1665132142.5078888, 1679196991.165163, 1696745632.0251458, 1677026934.900504, 1690161905.127059, 1674125786.6438968, 1652768306.5442123, 1668046899.5671964, 1609645249.7450132, 1642299157.9041529, 1628731838.757639, 1656780094.4246662, 1590017062.442266, 1627202143.24795, 1543501610.159628, 1580202754.0324674, 1590764841.7889843, 1611436072.2130294, 1490710856.536094, 1546709337.2181654, 1499131071.8018248, 1566816527.0650654, 1420482743.9944265, 911530776.2566117, 938458408.753808, 933557420.7623338, 925600988.2882112, 921865818.4122041, 915035742.4256926, 936683612.459098, 924752205.7966597, 896923184.9800407, 923209425.379771, 910319470.6974685, 905356431.5520792, 929056688.234386, 916998347.1495844, 970836014.2526667, 960337526.1324683, 953657704.0599997, 946432337.2547642, 965779735.3602539, 950450539.1798308, 948090950.5374167, 935768585.453674, 954466015.7072029, 941555597.9947288, 875127306.7619616, 919599074.830267, 862780218.6148264, 917470323.7774311, 898385883.7185804, 891575142.2518635, 957549790.5637388, 962575551.9765624, 939231609.995024, 941004091.0756971, 886683073.6223209, 921567720.1108031, 904718633.5174055, 952734188.2721223, 937515688.4172682, 1009426472.5231663, 984912624.8381693, 997433690.484128, 1030258665.8433875, 998200120.616184, 1014542952.4243609, 989516723.0222344, 972264210.5794085, 981123821.1744574, 971696697.577219, 980997581.8230771, 962846604.1137799, 819302593.6301887, 723244054.5511498, 769916144.2587771, 903176847.0733479, 769849801.3187786, 833258307.9060172, 674594953.2852919, 635776092.1038026, 655056118.7388146, 744128323.0624449, 678717523.1923361, 710876214.1259828, 635835457.2079306, 678765823.6069152, 655141441.1721783, 710957413.6751376, 597984519.7486323, 616769215.976664, 616792967.5587585, 647419147.0010464, 545595776.5672585, 527438718.51992106, 536498179.8852153, 608897073.947636, 580878894.2834091, 594826709.1139662, 483883197.3972041, 474969849.87732947, 479414864.4957296, 509450748.93606037, 518421502.8313076, 553297469.8410242, 567039319.1258196, 466167382.1825004, 470552325.37391543, 527698826.60140765, 581041358.3655254, 536913396.9949574, 595077589.9327748, 518545282.0158393, 567120553.7314582, 475371402.0760996, 480056314.21893615, 470745822.4399995, 876187802.479594, 867801644.7935017, 898135582.048948, 900734670.6067961, 849210350.701993, 834824427.9262832, 859947909.1782798, 846812357.5826368, 888480097.2668015, 882744869.498701, 897245140.1852759, 897006714.9829898, 872655855.2986232, 861768068.3361326, 880181691.5675379, 870964428.8460419, 854468742.386585, 863228464.0637822, 838749415.840254, 848751549.8073375, 880861409.964271, 888052932.7256131, 868561851.7857395, 876438796.6254597, 849543487.9947735, 833780587.2251203, 875619132.57309, 863517163.8397722, 895191305.4986415, 900657693.2575846, 902316844.711862, 906634962.575585, 890447244.1248385, 897414656.0057231, 888465090.1284219, 895989943.4692874, 883089031.5520526, 723851070.3321921, 770739129.9083651, 771251814.0194771, 834203674.3839204, 634681347.0725785, 655303160.9439135, 678488226.3895701, 711479500.7522138, 636220576.8977566, 679190736.9813479, 657555459.5134968, 712781244.2859427, 594415838.4031025, 614399057.7758851, 615185578.749345, 646445908.0694667, 528234791.1695619, 537679347.1305435, 580808495.1265194, 595612657.6156502, 425281399.45686525, 424744860.94417685, 476522158.76385283, 480902485.06783557, 509712315.93435675, 518906991.7039771, 551725122.0514423, 566181083.00733, 426823578.3017676, 425960871.6659703, 468143596.1159543, 472261178.41431737, 531016262.4214617, 582958670.387138, 541930319.5713964, 598837448.2011377, 520281873.4629858, 567260324.9769802, 429307434.5444392, 479946446.5241352, 431065212.8056717, 486209642.7206107, 427919583.1743989, 473937371.8713547, 346464769.25984013, 338327808.4827975, 386486035.91312, 382270522.31726277, 262420596.18188182, 245607560.41210675, 305130822.71979564, 292801597.4344743, 362888993.3265404, 354646006.12212116, 395256778.1048035, 390806140.8010979, 295611130.003571, 279085258.08227825, 329684383.1647457, 317420989.0512958, 192777282.19271952, 156525973.01063442, 156168912.4816231, 109183651.02601005, 263672801.1518342, 247404503.6535973, 228602267.56038523, 202584556.6844938, 228065759.58475703, 201630060.8942739, 279739401.7545543, 254096608.85226834, 348996030.7562467, 389757469.54016936, 342176208.1190346, 387335890.72533554, 355906468.595125, 392411129.8550929, 306979647.9892601, 295544790.69397753, 318360134.4782064, 1401357159.6343353, 1324150717.8445094, 1403504160.7203557, 1347726979.3266985, 1402210451.5495243, 1335371606.2686427, 1364532537.453078, 1376689384.5817924, 1370242998.8039756, 1282798976.3254309, 1256391095.7195985, 1280171372.7833862, 1316489867.1185145, 1297470274.0034473, 1407533354.4605677, 1375887726.7877195, 1405265928.3445797, 1361247264.2671092, 1391932813.8084617, 1383912676.5772157, 1342667475.181308, 1311726740.027083, 1359432650.3409188, 1337206879.378843, 1482044390.7358863, 1446317697.0727355, 1472692952.8278143, 1425367830.8720546, 1476503835.4919412, 1435545962.988719, 1464608474.5607834, 1449456120.1271362, 1456442126.4209282, 1427264472.6740775, 1400758678.497709, 1413994688.6624167, 1407740884.5820012, 1470972961.02156, 1415984311.2563796, 1440223063.89859, 1443939429.807109, 1374930992.2016575, 1387675377.9396036, 1464649586.2037728, 1496947198.1116629, 1454086700.811599, 1505666590.6023157, 1459080867.0828874, 1491337804.8995442, 1476475248.0972185, 1483624730.3166604, 1434695371.5932717, 1429763863.4851532, 1431960180.8830779, 1488968942.4350111, 1449785145.8440235, 1470063905.3561738, 1428172584.0376532, 1580128784.6204267, 1591288611.2686222, 1553014943.3159757, 1576068461.134243, 1567881750.9602334, 1584392958.621372, 1586094577.2698572, 1565363379.8695023, 1576722274.5630522, 1599309394.9912136, 1592533616.6652632, 1596224824.0327406, 1595696589.6382654, 1585124348.677067, 1590896178.7550118, 1535388061.9409678, 1566274546.066651, 1551957410.558139, 1588233856.4568872, 1578364872.287273, 1599689123.9852269, 1602261533.94568, 1601032988.4134133, 1591670299.0300338, 1597749892.2943318, 1594900666.09698, 1605852235.1998482, 1605769071.5403137, 1605799516.642484, 1604350575.0659666, 1604911737.2964947, 1604627734.9977205, 1604158173.90424, 1603282713.5728204, 1602151286.1845903, 1600152148.3084047, 1605739043.597341, 1605745561.794265, 1605350289.3147557, 1605136971.9183948, 1602473841.1056962, 1603377054.2825937, 1598350469.247178, 1600409834.4899542, 1605731475.7201512, 1605731837.680113, 1604926003.3527906, 1605145311.9472926, 1601384569.4605393, 1595922274.0469513, 1605723275.8907888, 1604646280.2239811, 1370970494.7310581, 1319918262.1005988, 1425691436.9348714, 1366488557.169077, 1344999155.8397002, 1396072841.350446, 1274570587.2254465, 1309987189.7063794, 1296326252.1767595, 1337598908.4543953, 1230324851.2162952, 1208214299.2368531, 1306443731.0184734, 1267383974.1160684, 1218251240.8828487, 1286045400.6279778, 1194475682.6126485, 1236168978.374249, 1200312975.781777, 1250704213.9612796, 1205874614.60154, 1173431804.679063, 1245821872.2914813, 1216545803.42452, 1115758266.3765485, 1075758600.9899564, 1162642805.8592744, 1126635550.8064177, 1239795346.7674594, 1277161797.034044, 1155503746.400342, 1199342888.5611668, 1035103598.0162286, 1070697784.1321827, 1051136001.410701, 909464838.12457, 992138408.8606641, 949782298.1516685, 1140890065.6971447, 1142714791.5493703, 1140207188.8789732, 1092527918.2626016, 1034475613.7865626, 1147963012.0452394, 1420487638.3089967, 1442607672.054154, 1431547283.6498113, 1436630131.3053188, 1464578863.9337888, 1450732875.751084, 1385657566.9850245, 1393048523.4458296, 1389243761.2366307, 1403503002.407226, 1418778999.809342, 1411059813.981487, 1453653213.9066663, 1478132047.4512644, 1397083706.0623162, 1426659488.7358823, 1384455535.488359, 1401026404.6145515, 1402765833.9785275, 1419104080.1071286, 1365585681.562244, 1382423555.8184612, 1349331369.9356894, 1367231963.3293507, 1367811079.082959, 1385674110.5618336, 1330248900.9970555, 1348204637.2711995, 1336409594.657267, 1342803269.8123205, 1365616280.4620168, 1366587529.789088, 1305471510.0337691, 1317932538.9098997, 1330177029.5029492, 1364920983.8579233, 1292875893.0473468, 1594941997.438245, 1589226070.4783545, 1603849138.5754082, 1603157910.4251494, 1600110462.9144828, 1597234738.1621869, 1592200310.0118086, 1603448335.9562626, 1598689566.909629, 1582697474.9534233, 1602662692.1532607, 1594052174.0551705, 1586046204.8706675, 1602819635.9367824, 1595632068.270672, 1607058123.200372, 1608558805.6101532, 1606162819.3480642, 1606946468.6174276, 1607703590.7792952, 1606460048.0221627, 1608335212.9166193, 1609621882.5742917, 1607517715.9460793, 1587999984.921743, 1601766823.2061687, 1596093940.2952669, 1584163913.3497198, 1600678782.8095186, 1593889792.2079065, 1591604616.370211, 1602761780.6790946, 1598125484.038446, 1606219753.1242337, 1605109703.910873, 1605977448.7318285, 1604663880.7488363, 1606555715.5683472, 1605559103.7784326, 1572856526.932044, 1563308511.3279102, 1581040407.4754949, 1574680268.444519, 1552679689.4916303, 1534601972.9029827, 1563416300.992875, 1549979624.3023818, 1581533943.6626048, 1586901648.3344638, 1568817694.865164, 1575503793.3408625, 1537052226.7967095, 1517907519.4267528, 1544960634.5237844, 1526184732.6074405, 1521124088.666564, 1502491924.4663877, 1529069318.1997895, 1509950177.9225693, 1569281957.3645146, 1554212693.580681, 1576360139.6291318, 1561751480.8776693, 1552951407.680623, 1537936437.657884, 1561473558.541415, 1546256481.6687403, 1527480561.1300387, 1502135727.91523, 1523834606.2008758, 1501624023.547422, 1532074650.7433295, 1504152544.2183597, 1566973576.763842, 1549013441.1909573, 1559983528.219681, 1543247064.0036237, 1573859769.2766109, 1555191514.3985066, 1589208939.1415799, 1579807428.6153252, 1596984634.6511178, 1587611894.5180717, 1579234688.3639066, 1570607575.0226483, 1597368137.022497, 1604326638.6206121, 1587267961.5435069, 1039905082.055545, 949501052.4559056, 1035391462.8962086, 925962775.5052276, 1062153289.937775, 1014218280.122046, 1048857518.0248206, 979304796.1637655, 1188089124.3980591, 1118749612.8357646, 1208997530.925013, 1128726112.9171379, 1149277692.766564, 1107122881.876161, 1168026383.1055012, 1111427458.6859581, 1171816673.8569582, 1221139149.5813367, 1129199468.7171772, 1182318481.3875003, 1254076203.9716341, 1299364000.5612917, 1213695668.8067908, 1260557498.7312648, 1118812999.1731806, 1073027753.0550677, 1204208838.6438544, 1162651736.4147708, 1313803846.4771755, 1342944892.060469, 1365400212.0834467, 1396458028.0379114, 1254997258.1970787, 1280837773.626289, 1284014176.0582378, 1332863219.748411, 1229292990.3163826, 1780625510.7121658, 1775290493.5334737, 1788503235.6210515, 1776652486.1499367, 1785133980.136931, 1776264307.7037773, 1780134862.097838, 1785823862.4678247, 1783382698.63028, 1751852036.518146, 1739296499.3904235, 1745965028.868181, 1765917103.8530948, 1761387312.9268742, 1763936399.8015099, 1791163860.2288408, 1775439896.4151506, 1790430825.3955157, 1776288636.3898978, 1787365975.2132976, 1787006630.43902, 1724021227.0809615, 1731945117.387084, 1754571598.998209, 1758189334.1462514, 1742440517.9519985, 1767886114.3835166, 1761197321.953094, 1759834171.0708768, 1752148210.4483318, 1751866637.924117, 1768095623.5589275, 1760306861.9319658, 1693112905.5836048, 1725570067.296485, 1710082842.767796, 1722783032.4613788, 1747044294.9221683, 1735399833.7388797, 1774777608.5319273, 1768643348.085025, 1774526952.7238367, 1739508907.835473, 1757012397.3046043, 1605227025.3928964, 1684079135.9707994, 1647817845.4311798, 1653763902.7624447, 1706581969.209303, 1681910690.680553, 1629655925.28405, 1563385293.7575467, 1547984320.01064, 1658313331.800368, 1608189496.999181, 1714457165.8946915, 1727900659.7571251, 1682726264.23401, 1699342035.8090286, 786654479.5393969, 958075701.3883864, 763305321.8736454, 954492688.8835258, 876032340.3228061, 863187101.8547572, 1033989357.0421956, 1038121728.6719517, 854089564.590595, 984272912.6269852, 817277190.2087735, 967653765.8393172, 921069632.4997948, 894947815.5675654, 1043988704.6161703, 1035473089.2286268, 839097454.8420608, 999001974.4903353, 923208602.6476254, 839753903.576196, 1019196009.8309989, 934936072.1982116, 844426122.0230293, 987671677.574127, 918895462.3581344, 1067877482.6597393, 1094221982.0541153, 1051314017.1934608, 658177204.1544691, 569264314.8792058, 601501911.7400005, 454653174.43308794, 723138369.9925448, 668368039.26397, 750746733.1622838, 728362722.781848, 781818592.103762, 1681116911.935012, 1704742738.0950859, 1717249438.672192, 1734712234.1878815, 1570749484.2909086, 1599316765.9539633, 1632731636.658787, 1660156627.886233, 1615810928.5926876, 1651377821.848909, 1658078417.809249, 1691599752.8356996, 1506669759.162097, 1539775783.6787214, 1565574355.159794, 1601091770.127915, 1426763248.6505754, 1431937145.2116776, 1504986548.7704203, 1524962385.9182296, 1334741276.2115066, 1317604328.6441658, 1420749962.4973257, 1423071802.3076413, 1465515044.099078, 1485138090.022985, 1372246863.673414, 1353048605.7710516, 1522624689.1450567, 1572310207.2926035, 1566182331.8322623, 1615944866.0838215, 1474241380.9702642, 1522325046.6157207, 1466857066.9599648, 1509056187.2071164, 1421288894.4722536]

    @classmethod
    def tearDownClass(self):
        # restore state
        agros2d.options.save_matrix_and_rhs = self.save_matrix_and_rhs
        agros2d.options.dump_format = self.dump_format

    @classmethod
    def model(self, solver, matrix_solver="", matrix_solver_parameters=""):
        problem = agros2d.problem(clear = True)
        problem.coordinate_type = "axisymmetric"
        problem.mesh_type = "triangle"

        electrostatic = problem.field("electrostatic")
        electrostatic.analysis_type = "steadystate"
        electrostatic.matrix_solver = solver
        electrostatic.number_of_refinements = 1
        electrostatic.polynomial_order = 2
        electrostatic.adaptivity_type = "disabled"
        electrostatic.solver = "linear"

        electrostatic.matrix_solver_parameters['external_solver'] = matrix_solver
        electrostatic.matrix_solver_parameters['external_parameters'] = matrix_solver_parameters        
                
        electrostatic.add_boundary("Source", "electrostatic_potential", {"electrostatic_potential" : 1e9})
        electrostatic.add_boundary("Ground", "electrostatic_potential", {"electrostatic_potential" : 0})
        electrostatic.add_boundary("Neumann", "electrostatic_surface_charge_density", {"electrostatic_surface_charge_density" : 0})
        electrostatic.add_material("Air", {"electrostatic_permittivity" : 1, "electrostatic_charge_density" : 1})
        electrostatic.add_material("Dielectric 1", {"electrostatic_permittivity" : 3, "electrostatic_charge_density" : 20})
        electrostatic.add_material("Dielectric 2", {"electrostatic_permittivity" : 4, "electrostatic_charge_density" : 30})
        
        geometry = problem.geometry()
        geometry.add_edge(0, 0.2, 0, 0.08, boundaries = {"electrostatic" : "Neumann"})
        geometry.add_edge(0.01, 0.08, 0.01, 0, refinements = {"electrostatic" : 1}, boundaries = {"electrostatic" : "Source"})
        geometry.add_edge(0.01, 0, 0.03, 0, boundaries = {"electrostatic" : "Neumann"})
        geometry.add_edge(0.03, 0, 0.03, 0.08)
        geometry.add_edge(0.03, 0.08, 0.05, 0.08)
        geometry.add_edge(0.05, 0, 0.03, 0, boundaries = {"electrostatic" : "Neumann"})
        geometry.add_edge(0.05, 0.08, 0.05, 0, refinements = {"electrostatic" : 1}, boundaries = {"electrostatic" : "Ground"})
        geometry.add_edge(0.06, 0, 0.06, 0.08, boundaries = {"electrostatic" : "Ground"})
        geometry.add_edge(0.05, 0.08, 0.06, 0.08, refinements = {"electrostatic" : 1}, boundaries = {"electrostatic" : "Ground"})
        geometry.add_edge(0.06, 0, 0.2, 0, boundaries = {"electrostatic" : "Neumann"})
        geometry.add_edge(0.2, 0, 0, 0.2, angle = 90, boundaries = {"electrostatic" : "Neumann"})
        geometry.add_edge(0.01, 0.08, 0.03, 0.08)
        geometry.add_edge(0.01, 0.08, 0, 0.08, refinements = {"electrostatic" : 1}, boundaries = {"electrostatic" : "Source"})

        geometry.add_label(0.019, 0.021, materials = {"electrostatic" : "Dielectric 1"})
        geometry.add_label(0.0379, 0.051, materials = {"electrostatic" : "Dielectric 2"})
        geometry.add_label(0.0284191, 0.123601, materials = {"electrostatic" : "Air"})
        
        computation = problem.computation()
        computation.solve()
        solution = computation.solution("electrostatic")
    
        return solution.solution()

    """    
    @classmethod    
    def analyse_system(self, filename_matrix, filename_rhs, filename_sln):
        import pylab as pl

        # read matrix and rhs from file
        matrix, rhs, sln = self.read_system(filename_matrix, filename_rhs, filename_sln)
              
        # size of the matrix
        print(("Matrix size: " + str(len(rhs))))
        print(("Number of nonzeros: " + str(matrix.getnnz()) + " (" + str(round(float(matrix.getnnz()) / (len(rhs)**2) * 100.0, 3)) + " %)"))
        
        # visualize matrix sparsity pattern
        fig = pl.figure()
        pl.spy(matrix, markersize=1)
        fn_pattern = pythonlab.tempname("png")
        pl.savefig(fn_pattern, dpi=60)
        pl.close(fig)   
        agros2d.image(fn_pattern)

    @classmethod        
    def read_system(self, filename_matrix, filename_rhs, filename_sln):
        mat_object = sio.loadmat(filename_matrix)
        matrix = mat_object["matrix"]
        rhs_object = sio.loadmat(filename_rhs)
        rhs = rhs_object["rhs"]
        sln_object = sio.loadmat(filename_sln)
        sln = sln_object["sln"]
        
        return matrix, rhs, sln
    """
class TestMatrixSolversInternal(TestMatrixSolversGeneral):
    def setUp(self):  
        self.setUpGeneral()
        
    def tearDown(self):
        self.tearDownClass()
        
    def test_umfpack(self):
        # UMFPACK
        sln = self.model("umfpack")    
        print(self.reference_sln)         
        print(sln)   
        self.assertTrue(np.allclose(self.reference_sln, sln, rtol=1e-15, atol=1e-6), "UMFPACK sln failed.")

    def test_dealii(self):
        # deal.II
        sln = self.model("dealii")
        self.assertTrue(np.allclose(self.reference_sln, sln, rtol=1e-6), "dealii sln failed.")                                                   

class TestMatrixSolversExternal(TestMatrixSolversGeneral):
    def setUp(self):  
        self.setUpGeneral()

    def tearDown(self):
        self.tearDownClass()
        
    def test_external_umfpack(self):
        # UMFPACK
        sln = self.model("external", "solver_UMFPACK.ext")        
        self.assertTrue(np.allclose(self.reference_sln, sln, rtol=1e-6), "UMFPACK (external) sln failed.")

    def test_external_mumps(self):
        # MUMPS
        sln = self.model("external", "solver_MUMPS.ext")        
        self.assertTrue(np.allclose(self.reference_sln, sln, rtol=1e-6), "MUMPS (external) sln failed.")

    def test_external_paralution(self):
        # PARALUTION
        sln = self.model("external", "solver_PARALUTION.ext")        
        self.assertTrue(np.allclose(self.reference_sln, sln, rtol=1e-6), "PARALUTION (external) sln failed.")

    def test_external_trilinos(self):
        # TRILINOS
        sln = self.model("external", "solver_TRILINOS.ext")        
        self.assertTrue(np.allclose(self.reference_sln, sln, rtol=1e-6), "TRILINOS (external) sln failed.")

    def test_external_petsc(self):
        # PETSC
        sln = self.model("external", "solver_PETSC.ext", "-l richardson -c hypre")     
        self.assertTrue(np.allclose(self.reference_sln, sln, rtol=1e-6), "PETSC (external) sln failed.")

if __name__ == '__main__':
    import unittest as ut

    suite = ut.TestSuite()
    result = Agros2DTestResult()
    suite.addTest(ut.TestLoader().loadTestsFromTestCase(TestMatrixSolversInternal))
    suite.addTest(ut.TestLoader().loadTestsFromTestCase(TestMatrixSolversExternal))    
    suite.run(result)
