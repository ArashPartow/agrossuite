<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>The deal.II Library: Sparsity patterns</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link rel="SHORTCUT ICON" href="http://www.dealii.org/deal.ico"></link>
<meta name="author" content="The deal.II Authors <authors@dealii.org>"></meta>
<meta name="copyright" content="Copyright (C) 1998 - 2014 by the deal.II authors"></meta>
<meta name="deal.II-version" content="8.1.0"></meta>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo200.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">
   &#160;<span id="projectnumber">Reference documentation for deal.II version 8.1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#namespaces">Namespaces</a> &#124;
<a href="#nested-classes">Classes</a> &#124;
<a href="#typedef-members">Typedefs</a>  </div>
  <div class="headertitle">
<div class="title">Sparsity patterns<div class="ingroups"><a class="el" href="group__Matrices.html">Matrix classes</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for Sparsity patterns:</div>
<div class="dyncontent">
<center><table><tr><td><div class="center"><iframe scrolling="no" frameborder="0" src="group__Sparsity.svg" width="614" height="75"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</td></tr></table></center>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:namespaceTrilinosWrappers"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceTrilinosWrappers.html">TrilinosWrappers</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespaceSparsityTools"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceSparsityTools.html">SparsityTools</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespaceSparsityPatternIterators"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceSparsityPatternIterators.html">SparsityPatternIterators</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespaceChunkSparsityPatternIterators"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceChunkSparsityPatternIterators.html">ChunkSparsityPatternIterators</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBlockSparsityPatternBase.html">BlockSparsityPatternBase&lt; SparsityType &gt;</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBlockSparsityPattern.html">BlockSparsityPattern</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBlockCompressedSparsityPattern.html">BlockCompressedSparsityPattern</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBlockCompressedSetSparsityPattern.html">BlockCompressedSetSparsityPattern</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classBlockCompressedSimpleSparsityPattern.html">BlockCompressedSimpleSparsityPattern</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTrilinosWrappers_1_1SparsityPattern.html">TrilinosWrappers::SparsityPattern</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classChunkSparsityPattern.html">ChunkSparsityPattern</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCompressedSetSparsityPattern.html">CompressedSetSparsityPattern</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCompressedSimpleSparsityPattern.html">CompressedSimpleSparsityPattern</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classCompressedSparsityPattern.html">CompressedSparsityPattern</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga0849dabf81f46d4d964e251c286784dd"><td class="memItemLeft" align="right" valign="top">typedef <br class="typebreak"/>
<a class="el" href="classBlockCompressedSparsityPattern.html">BlockCompressedSparsityPattern</a> <br class="typebreak"/>
CompressedBlockSparsityPattern&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__Sparsity.html#ga0849dabf81f46d4d964e251c286784dd">DEAL_II_DEPRECATED</a></td></tr>
<tr class="separator:ga0849dabf81f46d4d964e251c286784dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>In deal.II, sparsity patterns are typically separated from the actual sparse matrices (with the exception of the <a class="el" href="classSparseMatrixEZ.html">SparseMatrixEZ</a> class and some classes from interfaces to external libraries such as PETSc). The reason is that one often has several matrices that share the same sparsity pattern; examples include the stiffness and mass matrices necessary for time stepping schemes, or the left and right hand side matrix of generalized eigenvalue problems. It would therefore be wasteful if each of them had to store their sparsity pattern separately.</p>
<p>Consequently, deal.II has sparsity pattern classes that matrix classes build on. There are two main groups of sparsity pattern classes, as discussed below:</p>
<h4>"Static" sparsity patterns</h4>
<p>The main sparse matrix class in deal.II, <a class="el" href="classSparseMatrix.html">SparseMatrix</a>, only stores a value for each matrix entry, but not where these entries are located. For this, it relies on the information it gets from a sparsity pattern object associated with this matrix. This sparsity pattern object must be of type <a class="el" href="classSparsityPattern.html">SparsityPattern</a>.</p>
<p>Because matrices are large objects and because it is comparatively expensive to change them, <a class="el" href="classSparsityPattern.html">SparsityPattern</a> objects are built in two phases: first, in a "dynamic" phase, one allocates positions where one expects matrices built on it to have nonzero entries; in a second "static" phase, the representation of these nonzero locations is "compressed" into the usual Compressed Row Storage (CSR) format. After this, no new nonzero locations can be added any more. Only after compression can a sparsity pattern be associated to a matrix, since the latter requires the efficient compressed data format of the former. Building a sparsity pattern during the dynamic phase often happens with the <a class="el" href="namespaceDoFTools.html">DoFTools</a>:<a class="el" href="group__constraints.html#gab627b1d4845c9526521dbd1be83469dc">make_sparsity_pattern()</a> function. Although this may appear a restriction, it is typically not a significant problem to first build a sparsity pattern and then to write into the matrix only in the previously allocated locations, since in finite element codes it is normally quite clear which elements of a matrix can possibly be nonzero and which are definitely zero.</p>
<p>The advantage of this two-phase generation of a sparsity pattern is that when it is actually used with a matrix, a very efficient format is available. In particular, the locations of entries are stored in a linear array that allows for rapid access friendly to modern CPU types with deep hierarchies of caches. Consequently, the static <a class="el" href="classSparsityPattern.html">SparsityPattern</a> class is the only one on which deal.II's main <a class="el" href="classSparseMatrix.html">SparseMatrix</a> class can work.</p>
<p>The main drawback of static sparsity patterns is that their efficient construction requires a reasonably good guess how many entries each of the rows may maximally have. During the actual construction, for example in the <a class="el" href="namespaceDoFTools.html">DoFTools</a>:<a class="el" href="group__constraints.html#gab627b1d4845c9526521dbd1be83469dc">make_sparsity_pattern()</a> function, only at most as many entries can be allocated as previously stated. This is a problem because it is often difficult to estimate the maximal number of entries per row. Consequently, a common strategy is to first build and intermediate sparsity pattern that uses a less efficient storage scheme during construction of the sparsity pattern and later copy it directly into the static, compressed form. Most tutorial programs do this, starting at <a class="el" href="step_2.html">step-2</a> (see also, for example the <a class="el" href="step_11.html">step-11</a>, <a class="el" href="step_18.html">step-18</a>, and <a class="el" href="step_27.html">step-27</a> tutorial programs).</p>
<h4>"Dynamic" or "compressed" sparsity patterns</h4>
<p>As explained above, it is often complicated to obtain good estimates for the maximal number of entries in each row of a sparsity pattern. Consequently, any attempts to allocate a regular <a class="el" href="classSparsityPattern.html">SparsityPattern</a> with bad estimates requires huge amounts of memory, almost all of which will not be used and be de-allocated upon compression.</p>
<p>To avoid this, deal.II contains a number of "dynamic" or "compressed" sparsity patterns that only allocate as much memory as necessary to hold the currently added entries. While this saves much memory compared to the worst-case behavior mentioned above, it requires the use of less efficient storage schemes for insertion of elements, and the frequent allocation of memory often also takes significant compute time. The tradeoff to avoid excessive memory allocation cannot be avoided, however.</p>
<p>The following classes implement this "dynamic" memory scheme in deal.II:</p>
<ul>
<li><a class="el" href="classCompressedSparsityPattern.html">CompressedSparsityPattern</a></li>
<li><a class="el" href="classCompressedSimpleSparsityPattern.html">CompressedSimpleSparsityPattern</a></li>
<li><a class="el" href="classCompressedSetSparsityPattern.html">CompressedSetSparsityPattern</a></li>
</ul>
<p>These classes have different performance characteristics and memory requirements. Which one is the "best" changes from case to case because it is dependent on the number of dofs, the number of couplings per dof, the strategy used to insert and the amount of memory available.</p>
<p><a class="el" href="classCompressedSparsityPattern.html">CompressedSparsityPattern</a> and <a class="el" href="classCompressedSimpleSparsityPattern.html">CompressedSimpleSparsityPattern</a> are very similar, where <a class="el" href="classCompressedSimpleSparsityPattern.html">CompressedSimpleSparsityPattern</a> trades some memory (requires up to twice the memory in the worst case) for additional speed which is noticeable in cases with many nonzero entries. <a class="el" href="classCompressedSetSparsityPattern.html">CompressedSetSparsityPattern</a> on the other hand uses a lot more memory but may perform better in cases with many nonzero entries per row. See for example the <a class="el" href="step_27.html">step-27</a> and <a class="el" href="step_22.html">step-22</a> tutorial programs.</p>
<p>As a guideline you should start using <a class="el" href="classCompressedSparsityPattern.html">CompressedSparsityPattern</a> and try the other variants if you run into problems. Switching between them should be as simple as changing the class name because all classes have the same interface for adding entries. In either case, these classes are typically used in the following way (replace the class <a class="el" href="classCompressedSparsityPattern.html">CompressedSparsityPattern</a> with a different one from above): </p>
<pre class="fragment">* CompressedSparsityPattern compressed_pattern (dof_handler.n_dofs());
* DoFTools::make_sparsity_pattern (dof_handler,
*                                  compressed_pattern);
* constraints.condense (compressed_pattern);
*
* SparsityPattern final_sparsity_pattern;
* final_sparsity_pattern.copy_from (compressed_pattern);
* </pre><p>The intermediate, compressed sparsity pattern is directly copied into the "compressed" form of the final static pattern.</p>
<h4>Dynamic block sparsity patterns</h4>
<p>The following classes implement an array of dynamic sparsity patterns:</p>
<ul>
<li><a class="el" href="classBlockCompressedSparsityPattern.html">BlockCompressedSparsityPattern</a></li>
<li><a class="el" href="classBlockCompressedSetSparsityPattern.html">BlockCompressedSetSparsityPattern</a></li>
<li><a class="el" href="classBlockCompressedSimpleSparsityPattern.html">BlockCompressedSimpleSparsityPattern</a></li>
</ul>
<p>These classes inherit the same tradeoffs regarding their efficiency from their non-block classes (see above). See their documentation and <a class="el" href="step_22.html">step-22</a> for more information. </p>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="ga0849dabf81f46d4d964e251c286784dd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="classBlockCompressedSparsityPattern.html">BlockCompressedSparsityPattern</a> CompressedBlockSparsityPattern <a class="el" href="group__Sparsity.html#ga0849dabf81f46d4d964e251c286784dd">DEAL_II_DEPRECATED</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>A typdef to preserve the old name CompressedBlockSparsityPattern even after we changed the naming of the class to <a class="el" href="classBlockCompressedSparsityPattern.html">BlockCompressedSparsityPattern</a>. The old name is now deprecated and user codes should use the name <a class="el" href="classBlockCompressedSparsityPattern.html">BlockCompressedSparsityPattern</a> instead.</p>
<dl class="deprecated"><dt><b><a class="el" href="deprecated.html#_deprecated000032">Deprecated:</a></b></dt><dd></dd></dl>

<p>Definition at line <a class="el" href="block__sparsity__pattern_8h_source.html#l00758">758</a> of file <a class="el" href="block__sparsity__pattern_8h_source.html">block_sparsity_pattern.h</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.6-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Jan 27 2014 15:27:14 for The deal.II Library by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
