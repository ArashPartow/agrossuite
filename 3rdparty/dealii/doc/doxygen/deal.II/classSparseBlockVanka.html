<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>The deal.II Library: SparseBlockVanka&lt; number &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link rel="SHORTCUT ICON" href="http://www.dealii.org/deal.ico"></link>
<meta name="author" content="The deal.II Authors <authors@dealii.org>"></meta>
<meta name="copyright" content="Copyright (C) 1998 - 2014 by the deal.II authors"></meta>
<meta name="deal.II-version" content="8.1.0"></meta>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo200.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">
   &#160;<span id="projectnumber">Reference documentation for deal.II version 8.1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classSparseBlockVanka-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">SparseBlockVanka&lt; number &gt; Class Template Reference<div class="ingroups"><a class="el" href="group__Preconditioners.html">Preconditioners and Relaxation Operators</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="sparse__vanka_8h_source.html">sparse_vanka.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for SparseBlockVanka&lt; number &gt;:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classSparseBlockVanka__inherit__graph.svg" width="211" height="118"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:abb5808d854335ef644940e5925bdc9f0"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparseBlockVanka.html#abb5808d854335ef644940e5925bdc9f0">BlockingStrategy</a> { <b>index_intervals</b>, 
<b>adaptive</b>
 }</td></tr>
<tr class="separator:abb5808d854335ef644940e5925bdc9f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2accb596a8f231c522aa49cb2dbcfd0c"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="namespacetypes.html#a3bf9e493f1aab00b04933b81856144c4">types::global_dof_index</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparseBlockVanka.html#a2accb596a8f231c522aa49cb2dbcfd0c">size_type</a></td></tr>
<tr class="separator:a2accb596a8f231c522aa49cb2dbcfd0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_types_classSparseVanka"><td colspan="2" onclick="javascript:toggleInherit('pub_types_classSparseVanka')"><img src="closed.png" alt="-"/>&#160;Public Types inherited from <a class="el" href="classSparseVanka.html">SparseVanka&lt; number &gt;</a></td></tr>
<tr class="memitem:a7d7738c14dd62c48e05fb9eac839d1ad inherit pub_types_classSparseVanka"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="namespacetypes.html#a3bf9e493f1aab00b04933b81856144c4">types::global_dof_index</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparseVanka.html#a7d7738c14dd62c48e05fb9eac839d1ad">size_type</a></td></tr>
<tr class="separator:a7d7738c14dd62c48e05fb9eac839d1ad inherit pub_types_classSparseVanka"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a8b0d704b1c13b5580efa84eae787008e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparseBlockVanka.html#a8b0d704b1c13b5580efa84eae787008e">SparseBlockVanka</a> (const <a class="el" href="classSparseMatrix.html">SparseMatrix</a>&lt; number &gt; &amp;M, const std::vector&lt; <a class="el" href="classbool.html">bool</a> &gt; &amp;<a class="el" href="classSparseVanka.html#adc632a5520362456f351a45c725ec1ad">selected</a>, const unsigned <a class="el" href="classint.html">int</a> <a class="el" href="classSparseBlockVanka.html#afd45c7bd085f644e45e541af3822ad00">n_blocks</a>, const <a class="el" href="classSparseBlockVanka.html#abb5808d854335ef644940e5925bdc9f0">BlockingStrategy</a> blocking_strategy, const <a class="el" href="classbool.html">bool</a> conserve_memory=false, const unsigned <a class="el" href="classint.html">int</a> <a class="el" href="classSparseVanka.html#a06feb6f661aaa8875fa2e732b130eb99">n_threads</a>=multithread_info.n_threads())</td></tr>
<tr class="separator:a8b0d704b1c13b5580efa84eae787008e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa65bd2a5001cfb3798fa57134dc5adbf"><td class="memTemplParams" colspan="2">template&lt;typename number2 &gt; </td></tr>
<tr class="memitem:aa65bd2a5001cfb3798fa57134dc5adbf"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classSparseBlockVanka.html#aa65bd2a5001cfb3798fa57134dc5adbf">vmult</a> (<a class="el" href="classVector.html">Vector</a>&lt; number2 &gt; &amp;dst, const <a class="el" href="classVector.html">Vector</a>&lt; number2 &gt; &amp;src) const </td></tr>
<tr class="separator:aa65bd2a5001cfb3798fa57134dc5adbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a573b58d8bda8b38ebb9eefb5e41bf496"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparseBlockVanka.html#a573b58d8bda8b38ebb9eefb5e41bf496">memory_consumption</a> () const </td></tr>
<tr class="separator:a573b58d8bda8b38ebb9eefb5e41bf496"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classSparseVanka"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classSparseVanka')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classSparseVanka.html">SparseVanka&lt; number &gt;</a></td></tr>
<tr class="memitem:a217868edfde6f72a5df7ff5f2099a795 inherit pub_methods_classSparseVanka"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparseVanka.html#a217868edfde6f72a5df7ff5f2099a795">SparseVanka</a> (const <a class="el" href="classSparseMatrix.html">SparseMatrix</a>&lt; number &gt; &amp;M, const std::vector&lt; <a class="el" href="classbool.html">bool</a> &gt; &amp;<a class="el" href="classSparseVanka.html#adc632a5520362456f351a45c725ec1ad">selected</a>, const <a class="el" href="classbool.html">bool</a> conserve_memory=false, const unsigned <a class="el" href="classint.html">int</a> <a class="el" href="classSparseVanka.html#a06feb6f661aaa8875fa2e732b130eb99">n_threads</a>=multithread_info.n_threads())</td></tr>
<tr class="separator:a217868edfde6f72a5df7ff5f2099a795 inherit pub_methods_classSparseVanka"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8efa61d88f54f6d6467c0c78b28a81b7 inherit pub_methods_classSparseVanka"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparseVanka.html#a8efa61d88f54f6d6467c0c78b28a81b7">~SparseVanka</a> ()</td></tr>
<tr class="separator:a8efa61d88f54f6d6467c0c78b28a81b7 inherit pub_methods_classSparseVanka"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace80149b19a3960fd1e342287ef5670f inherit pub_methods_classSparseVanka"><td class="memTemplParams" colspan="2">template&lt;typename number2 &gt; </td></tr>
<tr class="memitem:ace80149b19a3960fd1e342287ef5670f inherit pub_methods_classSparseVanka"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classSparseVanka.html#ace80149b19a3960fd1e342287ef5670f">vmult</a> (<a class="el" href="classVector.html">Vector</a>&lt; number2 &gt; &amp;dst, const <a class="el" href="classVector.html">Vector</a>&lt; number2 &gt; &amp;src) const </td></tr>
<tr class="separator:ace80149b19a3960fd1e342287ef5670f inherit pub_methods_classSparseVanka"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a8897bf5c46e8f2cbae9c94afed06af41"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparseBlockVanka.html#a8897bf5c46e8f2cbae9c94afed06af41">compute_dof_masks</a> (const <a class="el" href="classSparseMatrix.html">SparseMatrix</a>&lt; number &gt; &amp;M, const std::vector&lt; <a class="el" href="classbool.html">bool</a> &gt; &amp;<a class="el" href="classSparseVanka.html#adc632a5520362456f351a45c725ec1ad">selected</a>, const <a class="el" href="classSparseBlockVanka.html#abb5808d854335ef644940e5925bdc9f0">BlockingStrategy</a> blocking_strategy)</td></tr>
<tr class="separator:a8897bf5c46e8f2cbae9c94afed06af41"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:afd45c7bd085f644e45e541af3822ad00"><td class="memItemLeft" align="right" valign="top">const unsigned <a class="el" href="classint.html">int</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparseBlockVanka.html#afd45c7bd085f644e45e541af3822ad00">n_blocks</a></td></tr>
<tr class="separator:afd45c7bd085f644e45e541af3822ad00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af50eedb7f428138af6378d798e8ba057"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; <a class="el" href="classbool.html">bool</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparseBlockVanka.html#af50eedb7f428138af6378d798e8ba057">dof_masks</a></td></tr>
<tr class="separator:af50eedb7f428138af6378d798e8ba057"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_methods_classSparseVanka"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_classSparseVanka')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="classSparseVanka.html">SparseVanka&lt; number &gt;</a></td></tr>
<tr class="memitem:a54b8de8c9f87d62cedecc8b2a0e0f1e2 inherit pro_methods_classSparseVanka"><td class="memTemplParams" colspan="2">template&lt;typename number2 &gt; </td></tr>
<tr class="memitem:a54b8de8c9f87d62cedecc8b2a0e0f1e2 inherit pro_methods_classSparseVanka"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classSparseVanka.html#a54b8de8c9f87d62cedecc8b2a0e0f1e2">apply_preconditioner</a> (<a class="el" href="classVector.html">Vector</a>&lt; number2 &gt; &amp;dst, const <a class="el" href="classVector.html">Vector</a>&lt; number2 &gt; &amp;src, const std::vector&lt; <a class="el" href="classbool.html">bool</a> &gt; *const dof_mask=0) const </td></tr>
<tr class="separator:a54b8de8c9f87d62cedecc8b2a0e0f1e2 inherit pro_methods_classSparseVanka"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e51111cd9ffb98a63db660a311f23cb inherit pro_methods_classSparseVanka"><td class="memItemLeft" align="right" valign="top">std::size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparseVanka.html#a5e51111cd9ffb98a63db660a311f23cb">memory_consumption</a> () const </td></tr>
<tr class="separator:a5e51111cd9ffb98a63db660a311f23cb inherit pro_methods_classSparseVanka"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;typename number&gt;<br/>
class SparseBlockVanka&lt; number &gt;</h3>

<p>Block version of the sparse Vanka preconditioner. This class divides the matrix into blocks and works on the diagonal blocks only, which of course reduces the efficiency as preconditioner, but is perfectly parallelizable. The constructor takes a parameter into how many blocks the matrix shall be subdivided and then lets the underlying class do the work. Division of the matrix is done in several ways which are described in detail below.</p>
<p>This class is probably useless if you don't have a multiprocessor system, since then the amount of work per preconditioning step is the same as for the <code><a class="el" href="classSparseVanka.html">SparseVanka</a></code> class, but preconditioning properties are worse. On the other hand, if you have a multiprocessor system, the worse preconditioning quality (leading to more iterations of the linear solver) usually is well balanced by the increased speed of application due to the parallelization, leading to an overall decrease in elapsed wall-time for solving your linear system. It should be noted that the quality as preconditioner reduces with growing number of blocks, so there may be an optimal value (in terms of wall-time per linear solve) for the number of blocks.</p>
<p>To facilitate writing portable code, if the number of blocks into which the matrix is to be subdivided, is set to one, then this class acts just like the <code><a class="el" href="classSparseVanka.html">SparseVanka</a></code> class. You may therefore want to set the number of blocks equal to the number of processors you have.</p>
<p>Note that the parallelization is done if <code>deal.II</code> was configured for multithread use and that the number of threads which is spawned equals the number of blocks. This is reasonable since you will not want to set the number of blocks unnecessarily large, since, as mentioned, this reduces the preconditioning properties.</p>
<h3>Splitting the matrix into blocks</h3>
<p>Splitting the matrix into blocks is always done in a way such that the blocks are not necessarily of equal size, but such that the number of selected degrees of freedom for which a local system is to be solved is equal between blocks. The reason for this strategy to subdivision is load-balancing for multithreading. There are several possibilities to actually split the matrix into blocks, which are selected by the flag <code>blocking_strategy</code> that is passed to the constructor. By a block, we will in the sequel denote a list of indices of degrees of freedom; the algorithm will work on each block separately, i.e. the solutions of the local systems corresponding to a degree of freedom of one block will only be used to update the degrees of freedom belonging to the same block, but never to update degrees of freedoms of other blocks. A block can be a consecutive list of indices, as in the first alternative below, or a nonconsecutive list of indices. Of course, we assume that the intersection of each two blocks is empty and that the union of all blocks equals the interval <code>[0,N)</code>, where <code>N</code> is the number of degrees of freedom of the system of equations.</p>
<ul>
<li>
<p class="startli"><code>index_intervals:</code> Here, we chose the blocks to be intervals <code>[a_i,a_{i+1</code>)}, i.e. consecutive degrees of freedom are usually also within the same block. This is a reasonable strategy, if the degrees of freedom have, for example, be re-numbered using the Cuthill-McKee algorithm, in which spatially neighboring degrees of freedom have neighboring indices. In that case, coupling in the matrix is usually restricted to the vicinity of the diagonal as well, and we can simply cut the matrix into blocks.</p>
<p>The bounds of the intervals, i.e. the <code>a_i</code> above, are chosen such that the number of degrees of freedom on which we shall work (i.e. usually the degrees of freedom corresponding to Lagrange multipliers) is about the same in each block; this does not mean, however, that the sizes of the blocks are equal, since the blocks also comprise the other degrees of freedom for which no local system is solved. In the extreme case, consider that all Lagrange multipliers are sorted to the end of the range of DoF indices, then the first block would be very large, since it comprises all other DoFs and some Lagrange multipliers, while all other blocks are rather small and comprise only Langrange multipliers. This strategy therefore does not only depend on the order in which the Lagrange DoFs are sorted, but also on the order in which the other DoFs are sorted. It is therefore necessary to note that this almost renders the capability as preconditioner useless if the degrees of freedom are numbered by component, i.e. all Lagrange multipliers en bloc.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><code>adaptive:</code> This strategy is a bit more clever in cases where the Langrange DoFs are clustered, as in the example above. It works as follows: it first groups the Lagrange DoFs into blocks, using the same strategy as above. However, instead of grouping the other DoFs into the blocks of Lagrange DoFs with nearest DoF index, it decides for each non-Lagrange DoF to put it into the block of Lagrange DoFs which write to this non-Lagrange DoF most often. This makes it possible to even sort the Lagrange DoFs to the end and still associate spatially neighboring non-Lagrange DoFs to the same blocks where the respective Lagrange DoFs are, since they couple to each other while spatially distant DoFs don't couple.</p>
<p class="endli">The additional computational effort to sorting the non-Lagrange DoFs is not very large compared with the inversion of the local systems and applying the preconditioner, so this strategy might be reasonable if you want to sort your degrees of freedom by component. If the degrees of freedom are not sorted by component, the results of the both strategies outlined above does not differ much. However, unlike the first strategy, the performance of the second strategy does not deteriorate if the DoFs are renumbered by component. </p>
</li>
</ul>
<h3>Typical results</h3>
<p>As a prototypical test case, we use a nonlinear problem from optimization, which leads to a series of saddle point problems, each of which is solved using GMRES with Vanka as preconditioner. The equation had approx. 850 degrees of freedom. With the non-blocked version <code><a class="el" href="classSparseVanka.html">SparseVanka</a></code> (or <code><a class="el" href="classSparseBlockVanka.html">SparseBlockVanka</a></code> with <code>n_blocks==1</code>), the following numbers of iterations is needed to solver the linear system in each nonlinear step: </p>
<pre class="fragment">*   101 68 64 53 35 21
* </pre><p>With four blocks, we need the following numbers of iterations </p>
<pre class="fragment">*   124 88 83 66 44 28
* </pre><p> As can be seen, more iterations are needed. However, in terms of computing time, the first version needs 72 seconds wall time (and 79 seconds CPU time, which is more than wall time since some other parts of the program were parallelized as well), while the second version needed 53 second wall time (and 110 seconds CPU time) on a four processor machine. The total time is in both cases dominated by the linear solvers. In this case, it is therefore worth while using the blocked version of the preconditioner if wall time is more important than CPU time.</p>
<p>The results with the block version above were obtained with the first blocking strategy and the degrees of freedom were not numbered by component. Using the second strategy does not much change the numbers of iterations (at most by one in each step) and they also do not change when the degrees of freedom are sorted by component, while the first strategy significantly deteriorated.</p>
<dl class="section author"><dt>Author</dt><dd>Wolfgang Bangerth, 2000 </dd></dl>

<p>Definition at line <a class="el" href="sparse__vanka_8h_source.html#l00036">36</a> of file <a class="el" href="sparse__vanka_8h_source.html">sparse_vanka.h</a>.</p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a class="anchor" id="a2accb596a8f231c522aa49cb2dbcfd0c"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename number &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="namespacetypes.html#a3bf9e493f1aab00b04933b81856144c4">types::global_dof_index</a> <a class="el" href="classSparseBlockVanka.html">SparseBlockVanka</a>&lt; number &gt;::<a class="el" href="classSparseVanka.html#a7d7738c14dd62c48e05fb9eac839d1ad">size_type</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Declate type for container size. </p>

<p>Definition at line <a class="el" href="sparse__vanka_8h_source.html#l00523">523</a> of file <a class="el" href="sparse__vanka_8h_source.html">sparse_vanka.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Enumeration Documentation</h2>
<a class="anchor" id="abb5808d854335ef644940e5925bdc9f0"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename number &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classSparseBlockVanka.html#abb5808d854335ef644940e5925bdc9f0">SparseBlockVanka::BlockingStrategy</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Enumeration of the different methods by which the DoFs are distributed to the blocks on which we are to work. </p>

<p>Definition at line <a class="el" href="sparse__vanka_8h_source.html#l00531">531</a> of file <a class="el" href="sparse__vanka_8h_source.html">sparse_vanka.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a8b0d704b1c13b5580efa84eae787008e"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename number &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classSparseBlockVanka.html">SparseBlockVanka</a>&lt; number &gt;::<a class="el" href="classSparseBlockVanka.html">SparseBlockVanka</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classSparseMatrix.html">SparseMatrix</a>&lt; number &gt; &amp;&#160;</td>
          <td class="paramname"><em>M</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classbool.html">bool</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>selected</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned <a class="el" href="classint.html">int</a>&#160;</td>
          <td class="paramname"><em>n_blocks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classSparseBlockVanka.html#abb5808d854335ef644940e5925bdc9f0">BlockingStrategy</a>&#160;</td>
          <td class="paramname"><em>blocking_strategy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>conserve_memory</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned <a class="el" href="classint.html">int</a>&#160;</td>
          <td class="paramname"><em>n_threads</em> = <code>multithread_info.n_threads()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Constructor. Pass all arguments except for <code>n_blocks</code> to the base class. </p>

<p>Definition at line <a class="el" href="sparse__vanka_8templates_8h_source.html#l00371">371</a> of file <a class="el" href="sparse__vanka_8templates_8h_source.html">sparse_vanka.templates.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="aa65bd2a5001cfb3798fa57134dc5adbf"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename number &gt; </div>
<div class="memtemplate">
template&lt;typename number2 &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classSparseBlockVanka.html">SparseBlockVanka</a>&lt; number &gt;::vmult </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classVector.html">Vector</a>&lt; number2 &gt; &amp;&#160;</td>
          <td class="paramname"><em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classVector.html">Vector</a>&lt; number2 &gt; &amp;&#160;</td>
          <td class="paramname"><em>src</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Apply the preconditioner. </p>

<p>Definition at line <a class="el" href="sparse__vanka_8templates_8h_source.html#l00553">553</a> of file <a class="el" href="sparse__vanka_8templates_8h_source.html">sparse_vanka.templates.h</a>.</p>

</div>
</div>
<a class="anchor" id="a573b58d8bda8b38ebb9eefb5e41bf496"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename number &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::size_t <a class="el" href="classSparseBlockVanka.html">SparseBlockVanka</a>&lt; number &gt;::memory_consumption </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Determine an estimate for the memory consumption (in bytes) of this object. </p>

<p>Definition at line <a class="el" href="sparse__vanka_8templates_8h_source.html#l00603">603</a> of file <a class="el" href="sparse__vanka_8templates_8h_source.html">sparse_vanka.templates.h</a>.</p>

</div>
</div>
<a class="anchor" id="a8897bf5c46e8f2cbae9c94afed06af41"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename number &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classSparseBlockVanka.html">SparseBlockVanka</a>&lt; number &gt;::compute_dof_masks </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classSparseMatrix.html">SparseMatrix</a>&lt; number &gt; &amp;&#160;</td>
          <td class="paramname"><em>M</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classbool.html">bool</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>selected</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classSparseBlockVanka.html#abb5808d854335ef644940e5925bdc9f0">BlockingStrategy</a>&#160;</td>
          <td class="paramname"><em>blocking_strategy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute the contents of the field <code>dof_masks</code>. This function is called from the constructor. </p>

<p>Definition at line <a class="el" href="sparse__vanka_8templates_8h_source.html#l00389">389</a> of file <a class="el" href="sparse__vanka_8templates_8h_source.html">sparse_vanka.templates.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="afd45c7bd085f644e45e541af3822ad00"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename number &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const unsigned <a class="el" href="classint.html">int</a> <a class="el" href="classSparseBlockVanka.html">SparseBlockVanka</a>&lt; number &gt;::n_blocks</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Store the number of blocks. </p>

<p>Definition at line <a class="el" href="sparse__vanka_8h_source.html#l00566">566</a> of file <a class="el" href="sparse__vanka_8h_source.html">sparse_vanka.h</a>.</p>

</div>
</div>
<a class="anchor" id="af50eedb7f428138af6378d798e8ba057"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename number &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::vector&lt;<a class="el" href="classbool.html">bool</a>&gt; &gt; <a class="el" href="classSparseBlockVanka.html">SparseBlockVanka</a>&lt; number &gt;::dof_masks</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>In this field, we precompute for each block which degrees of freedom belong to it. Thus, if <code>dof_masks[i][j]==true</code>, then DoF <code>j</code> belongs to block <code>i</code>. Of course, no other <code>dof_masks[l][j]</code> may be <code>true</code> for <code>l!=i</code>. This computation is done in the constructor, to avoid recomputing each time the preconditioner is called. </p>

<p>Definition at line <a class="el" href="sparse__vanka_8h_source.html#l00582">582</a> of file <a class="el" href="sparse__vanka_8h_source.html">sparse_vanka.h</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>include/deal.II/lac/<a class="el" href="sparse__vanka_8h_source.html">sparse_vanka.h</a></li>
<li>include/deal.II/lac/<a class="el" href="sparse__vanka_8templates_8h_source.html">sparse_vanka.templates.h</a></li>
</ul>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.6-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Jan 27 2014 15:27:21 for The deal.II Library by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
